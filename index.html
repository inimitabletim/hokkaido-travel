<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="2025年10月北海道8天7夜家庭旅遊完整指南，包含札幌、小樽、函館等景點推薦、交通攻略、美食餐廳及行前準備清單。">
    <meta name="keywords" content="北海道旅遊,北海道自由行,札幌旅遊,小樽旅遊,函館旅遊,北海道美食,日本旅遊,家庭旅遊">
    <meta name="author" content="北海道家庭旅遊指南">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="北海道家庭旅遊指南 | 2025.10.11-10.18">
    <meta property="og:description" content="8天7夜北海道家庭旅遊完整攻略，涵蓋札幌、小樽、函館等熱門景點、交通指南、美食推薦及行前準備。">
    <meta property="og:site_name" content="北海道家庭旅遊指南">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="北海道家庭旅遊指南 | 2025.10.11-10.18">
    <meta name="twitter:description" content="8天7夜北海道家庭旅遊完整攻略，涵蓋札幌、小樽、函館等熱門景點、交通指南、美食推薦及行前準備。">

    <title>北海道家庭旅遊指南 | 2025.10.11-10.18 | 8天7夜完整攻略</title>
    <style>
        :root {
            /* 主題色 - 北海道天空與薰衣草 */
            --bg-gradient-start: #667eea;
            --bg-gradient-end: #764ba2;
            --container-bg: white;
            --text-color: #333;
            --text-secondary: #666;
            --card-bg: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --nav-bg: #f8f9fa;
            --nav-border: #e9ecef;
            --shadow-color: rgba(0,0,0,0.2);
            --checklist-bg: #f8f9fa;
            --info-bg: white;
            --highlight-bg: #e9ecef;
            --border-color: #dee2e6;

            /* 日本傳統色彩系統（和色） */
            /* 🍜 美食主題 - 柿色/琥珀色 */
            --food-primary: #ed6d3d;
            --food-secondary: #ca6924;
            --food-light: #fff3e0;
            --food-bg: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);

            /* 🚃 交通主題 - 空色/瑠璃色 */
            --transport-primary: #1e50a2;
            --transport-secondary: #5472d3;
            --transport-light: #e3f2fd;
            --transport-bg: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);

            /* 🏛️ 景點主題 - 若竹色/萌黃 */
            --attraction-primary: #68be8d;
            --attraction-secondary: #aacf53;
            --attraction-light: #e8f5e9;
            --attraction-bg: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);

            /* 💡 提示主題 - 山吹色/金茶 */
            --tip-primary: #f8b500;
            --tip-secondary: #c7802d;
            --tip-light: #fff9c4;
            --tip-bg: #fff3cd;
            --tip-border: #f8b500;

            /* 📋 行程主題 - 藤色/菖蒲色 */
            --schedule-primary: #674598;
            --schedule-secondary: #bbbcde;
            --schedule-light: #f3e5f5;
            --schedule-bg: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);

            /* 通用色彩 */
            --success-bg: #d4edda;
            --warning-bg: #fff3cd;
            --info-light-bg: #e3f2fd;
            --orange-bg: #fff3e0;
            --purple-bg: #f3e5f5;
            --pink-bg: #fce4ec;
            --yellow-bg: #fff9c4;
            --light-blue-bg: #e1f5fe;
            --light-green-bg: #e8f5e9;

            /* 字體層級系統 */
            --font-size-h1: 28px;
            --font-size-h2: 22px;
            --font-size-h3: 18px;
            --font-size-body: 15px;
            --font-size-small: 13px;
            --font-size-tiny: 11px;

            --line-height-heading: 1.3;
            --line-height-body: 1.6;
            --line-height-compact: 1.4;
        }

        body.dark-mode {
            /* 主題色 */
            --bg-gradient-start: #1a1a2e;
            --bg-gradient-end: #16213e;
            --container-bg: #0f3460;
            --text-color: #e8e8e8;
            --text-secondary: #b0b0b0;
            --card-bg: linear-gradient(135deg, #1e2a3a 0%, #243447 100%);
            --nav-bg: #1a2332;
            --nav-border: #2a3f5f;
            --shadow-color: rgba(0,0,0,0.5);
            --checklist-bg: #1a2332;
            --info-bg: #1e2a3a;
            --highlight-bg: #2a3f5f;
            --border-color: #2a3f5f;

            /* 日本傳統色彩 - 深色模式調整 */
            --food-primary: #ff8a50;
            --food-secondary: #d47a35;
            --food-light: #3a2e1e;
            --food-bg: linear-gradient(135deg, #3a2e1e 0%, #4a3a2a 100%);

            --transport-primary: #5472d3;
            --transport-secondary: #3d5ba9;
            --transport-light: #1e2f3a;
            --transport-bg: linear-gradient(135deg, #1e2f3a 0%, #2a3f4a 100%);

            --attraction-primary: #7ddb9c;
            --attraction-secondary: #b8dc6e;
            --attraction-light: #1e3a1e;
            --attraction-bg: linear-gradient(135deg, #1e3a1e 0%, #2a4a2a 100%);

            --tip-primary: #ffc520;
            --tip-secondary: #d99033;
            --tip-light: #3d3a1e;
            --tip-bg: #3d4e26;
            --tip-border: #ffc520;

            --schedule-primary: #8b69b8;
            --schedule-secondary: #c5c6e5;
            --schedule-light: #2e1e3a;
            --schedule-bg: linear-gradient(135deg, #2e1e3a 0%, #3e2a4a 100%);

            /* 通用色彩 */
            --success-bg: #1e3a1e;
            --warning-bg: #3d3a1e;
            --info-light-bg: #1e2f3a;
            --orange-bg: #3a2e1e;
            --purple-bg: #2e1e3a;
            --pink-bg: #3a1e2e;
            --yellow-bg: #3a3a1e;
            --light-blue-bg: #1e2f3a;
            --light-green-bg: #1e3a1e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', 'PingFang TC', 'Noto Sans TC', sans-serif;
            line-height: var(--line-height-body);
            font-size: var(--font-size-body);
            color: var(--text-color);
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            padding: 10px;
            transition: background 0.3s ease, color 0.3s ease;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            background: var(--container-bg);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px var(--shadow-color);
            transition: background 0.3s ease;
        }
        
        .header {
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: var(--font-size-h1);
            line-height: var(--line-height-heading);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            font-size: var(--font-size-small);
            line-height: var(--line-height-compact);
            opacity: 0.9;
            font-weight: 400;
        }

        /* 字體層級 */
        h1 {
            font-size: var(--font-size-h1);
            line-height: var(--line-height-heading);
            font-weight: 700;
        }

        h2 {
            font-size: var(--font-size-h2);
            line-height: var(--line-height-heading);
            font-weight: 600;
        }

        h3 {
            font-size: var(--font-size-h3);
            line-height: var(--line-height-heading);
            font-weight: 600;
        }

        p {
            font-size: var(--font-size-body);
            line-height: var(--line-height-body);
        }

        .small-text {
            font-size: var(--font-size-small);
            line-height: var(--line-height-compact);
        }

        .tiny-text {
            font-size: var(--font-size-tiny);
            line-height: var(--line-height-compact);
        }

        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: background 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        /* 分享功能 */
        .share-button {
            position: absolute;
            top: 15px;
            right: 65px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .share-button:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        .share-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .share-modal.show {
            display: flex;
        }

        .share-modal-content {
            background: var(--container-bg);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
            position: relative;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .share-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .share-modal-title {
            font-size: var(--font-size-h2);
            font-weight: 700;
            color: var(--text-color);
        }

        .share-close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: var(--text-secondary);
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .share-close-btn:hover {
            background: var(--highlight-bg);
            color: var(--text-color);
        }

        .share-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .share-option-btn {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--info-bg);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--font-size-body);
            color: var(--text-color);
            font-family: inherit;
        }

        .share-option-btn:hover {
            border-color: var(--schedule-primary);
            background: var(--schedule-light);
            transform: translateX(5px);
        }

        .share-option-icon {
            font-size: 24px;
            width: 30px;
            text-align: center;
        }

        .share-option-text {
            flex: 1;
            text-align: left;
        }

        .share-option-label {
            font-weight: 600;
            display: block;
            margin-bottom: 3px;
        }

        .share-option-desc {
            font-size: var(--font-size-small);
            color: var(--text-secondary);
        }

        .share-preview {
            margin-top: 20px;
            padding: 15px;
            background: var(--highlight-bg);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }

        .share-preview-title {
            font-size: var(--font-size-small);
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .share-preview-content {
            font-size: var(--font-size-small);
            color: var(--text-color);
            line-height: var(--line-height-body);
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }

        .share-success {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #4ade80;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(74, 222, 128, 0.4);
            z-index: 10001;
            animation: slideDown 0.3s ease, slideUp 0.3s ease 2.7s;
            display: none;
        }

        .share-success.show {
            display: block;
        }

        @keyframes slideDown {
            from {
                transform: translate(-50%, -100%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, 0);
                opacity: 1;
            }
        }

        /* 進度追蹤系統 */
        .progress-container {
            margin-top: 15px;
            padding: 0 20px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .progress-bar-bg {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
        }

        .progress-bar-fill {
            background: linear-gradient(90deg, #4ade80 0%, #22c55e 100%);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(74, 222, 128, 0.5);
        }

        .day-progress {
            position: relative;
        }

        .day-progress-indicator {
            position: absolute;
            top: -5px;
            right: 5px;
            background: #22c55e;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .day-progress-indicator.complete {
            background: #22c55e;
        }

        .day-progress-indicator.partial {
            background: #f59e0b;
        }

        .day-progress-indicator.empty {
            background: #6b7280;
        }

        .nav-tabs {
            display: flex;
            background: var(--nav-bg);
            border-bottom: 2px solid var(--nav-border);
            position: sticky;
            top: 0;
            z-index: 100;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            transition: background 0.3s ease;
        }
        
        .nav-tab {
            flex: 1;
            min-width: 80px;
            padding: 15px 10px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .nav-tab.active {
            color: #667eea;
            background: var(--info-bg);
            font-weight: bold;
            box-shadow: inset 0 -3px 0 #667eea;
            transition: background 0.3s ease;
        }
        
        .content {
            padding: 20px;
        }
        
        .section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .day-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            transition: background 0.3s ease;
        }
        
        .day-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255,255,255,0.5);
        }
        
        .day-number {
            background: white;
            color: #667eea;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin-right: 15px;
        }
        
        .day-title {
            flex: 1;
        }
        
        .day-date {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .day-location {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
        
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 10px;
            bottom: 10px;
            width: 2px;
            background: #e9ecef;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 20px;
            width: 12px;
            height: 12px;
            background: #667eea;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 0 3px #f0f0f0;
        }
        
        .time-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .activity-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .activity-detail {
            font-size: 14px;
            color: #666;
            line-height: 1.5;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease, margin-top 0.3s ease;
            max-height: 2000px;
            opacity: 1;
            margin-top: 8px;
        }

        .timeline-item.collapsed .activity-detail {
            max-height: 0;
            opacity: 0;
            margin-top: 0;
        }

        .timeline-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .timeline-toggle-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px 10px;
            font-size: 18px;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            border-radius: 5px;
            flex-shrink: 0;
        }

        .timeline-toggle-btn:hover {
            background: var(--highlight-bg);
            color: var(--text-color);
        }

        .timeline-toggle-btn.collapsed::after {
            content: '▼';
        }

        .timeline-toggle-btn.expanded::after {
            content: '▲';
        }

        .timeline-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: flex-end;
        }

        .timeline-control-btn {
            background: var(--info-bg);
            border: 2px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 15px;
            border-radius: 8px;
            font-size: var(--font-size-small);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .timeline-control-btn:hover {
            border-color: var(--schedule-primary);
            background: var(--schedule-light);
            transform: translateY(-2px);
        }

        /* 每日摘要區塊 */
        .day-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .summary-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            cursor: pointer;
            user-select: none;
        }

        .summary-title {
            font-size: 16px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .summary-toggle {
            font-size: 20px;
            transition: transform 0.3s ease;
        }

        .day-summary.collapsed .summary-toggle {
            transform: rotate(180deg);
        }

        .summary-content {
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease;
            max-height: 500px;
            opacity: 1;
        }

        .day-summary.collapsed .summary-content {
            max-height: 0;
            opacity: 0;
        }

        .summary-section {
            margin-bottom: 12px;
        }

        .summary-section:last-child {
            margin-bottom: 0;
        }

        .summary-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .summary-items {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .summary-item {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .summary-alerts {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            padding: 10px 12px;
            font-size: 13px;
            line-height: 1.6;
        }

        .summary-alerts div {
            margin-bottom: 4px;
        }

        .summary-alerts div:last-child {
            margin-bottom: 0;
        }

        .transport-badge {
            display: inline-block;
            background: #28a745;
            color: white;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 12px;
            margin: 5px 0;
        }
        
        .food-badge {
            display: inline-block;
            background: #ff6b6b;
            color: white;
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 12px;
            margin: 5px 0;
        }

        /* 關鍵提醒標記系統 */
        .alert-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 3px 5px 3px 0;
            border: 2px solid;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.85; }
        }

        /* 時間敏感 */
        .alert-time-critical {
            background: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }

        /* 必須預約 */
        .alert-booking {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        /* 重要費用 */
        .alert-cost {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }

        /* 一般提醒 */
        .alert-info {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        /* 警告 */
        .alert-warning {
            background: #fff3e0;
            border-color: #ff9800;
            color: #e65100;
        }

        /* 浮動提醒按鈕 */
        .floating-alerts-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            border-radius: 50%;
            box-shadow: 0 4px 15px rgba(238, 90, 111, 0.4);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            z-index: 999;
            transition: all 0.3s ease;
            border: none;
        }

        .floating-alerts-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(238, 90, 111, 0.6);
        }

        .floating-alerts-btn .badge-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #fff;
            color: #ff6b6b;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #ff6b6b;
        }

        /* 提醒面板 */
        .alerts-panel {
            position: fixed;
            right: -400px;
            top: 0;
            width: 380px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: right 0.3s ease;
            overflow-y: auto;
        }

        .alerts-panel.show {
            right: 0;
        }

        .alerts-panel-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .alerts-panel-title {
            font-size: 18px;
            font-weight: bold;
        }

        .alerts-panel-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .alerts-panel-content {
            padding: 20px;
        }

        .alert-group {
            margin-bottom: 25px;
        }

        .alert-group-title {
            font-size: 14px;
            font-weight: bold;
            color: #666;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .alert-item {
            background: #f8f9fa;
            border-left: 4px solid;
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            font-size: 13px;
            line-height: 1.6;
            transition: all 0.2s ease;
        }

        .alert-item:hover {
            transform: translateX(-3px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .alert-item.time-critical {
            border-left-color: #ffc107;
            background: #fffbf0;
        }

        .alert-item.booking {
            border-left-color: #dc3545;
            background: #fff5f5;
        }

        .alert-item.cost {
            border-left-color: #17a2b8;
            background: #f0f9fb;
        }

        .alert-item.info {
            border-left-color: #28a745;
            background: #f0fdf4;
        }

        .alert-item-day {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        /* 面板背景遮罩 */
        .alerts-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .alerts-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .tip-box {
            background: var(--tip-bg);
            border-left: 4px solid var(--tip-border);
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            transition: background 0.3s ease;
        }

        /* 和色主題類別 */
        .theme-food {
            background: var(--food-light) !important;
            border-left: 4px solid var(--food-primary) !important;
        }

        .theme-food .tip-title,
        .theme-food .transport-title {
            color: var(--food-primary) !important;
        }

        .theme-transport {
            background: var(--transport-light) !important;
            border-left: 4px solid var(--transport-primary) !important;
        }

        .theme-transport .tip-title,
        .theme-transport .transport-title {
            color: var(--transport-primary) !important;
        }

        .theme-attraction {
            background: var(--attraction-light) !important;
            border-left: 4px solid var(--attraction-primary) !important;
        }

        .theme-attraction .tip-title {
            color: var(--attraction-primary) !important;
        }

        .theme-schedule {
            background: var(--schedule-light) !important;
            border-left: 4px solid var(--schedule-primary) !important;
        }

        .theme-schedule .day-header h2 {
            color: var(--schedule-primary) !important;
        }

        /* 徽章樣式 */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }

        .badge-food {
            background: var(--food-primary);
            color: white;
        }

        .badge-transport {
            background: var(--transport-primary);
            color: white;
        }

        .badge-attraction {
            background: var(--attraction-primary);
            color: white;
        }

        .tip-box .tip-title {
            font-weight: bold;
            color: var(--tip-primary);
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }
        
        .checklist {
            background: var(--checklist-bg);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            transition: background 0.3s ease;
        }

        .checklist-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--text-color);
            transition: color 0.3s ease;
        }
        
        .checklist-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background: var(--info-bg);
            border-radius: 8px;
            transition: all 0.3s;
            color: var(--text-color);
        }

        .checklist-item span {
            color: var(--text-color);
            font-size: 14px;
        }

        .checklist-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 5px var(--shadow-color);
        }

        .checkbox {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            cursor: pointer;
        }
        
        .restaurant-card {
            background: var(--info-bg);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border: 2px solid var(--border-color);
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        .restaurant-name {
            font-size: 16px;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }

        .restaurant-type {
            display: inline-block;
            background: var(--highlight-bg);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
            margin-right: 5px;
            transition: background 0.3s ease;
        }
        
        .price-range {
            color: #28a745;
            font-weight: bold;
        }
        
        .restaurant-detail {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 8px;
            transition: color 0.3s ease;
        }
        
        .transport-info {
            background: linear-gradient(135deg, #a8e6cf 0%, #dcedc8 100%);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .transport-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .route-step {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .route-icon {
            width: 30px;
            height: 30px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-size: 16px;
        }
        
        .emergency-box {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .emergency-title {
            font-weight: bold;
            color: #721c24;
            margin-bottom: 10px;
        }
        
        .contact-item {
            background: var(--info-bg);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            font-size: 14px;
            transition: background 0.3s ease;
        }

        /* 響應式設計 - 平板 (768px以上) */
        @media screen and (min-width: 768px) {
            .container {
                max-width: 720px;
            }

            .header h1 {
                font-size: 32px;
            }

            .header .subtitle {
                font-size: 16px;
            }

            .nav-tab {
                font-size: 15px;
                padding: 18px 12px;
            }

            .content {
                padding: 30px;
            }

            .day-header {
                padding: 25px;
            }

            .day-number {
                font-size: 40px;
                width: 70px;
                height: 70px;
            }

            .day-date {
                font-size: 20px;
            }

            .day-location {
                font-size: 17px;
            }
        }

        /* 響應式設計 - 桌機 (1024px以上) */
        @media screen and (min-width: 1024px) {
            .container {
                max-width: 900px;
            }

            .header {
                padding: 40px 30px;
            }

            .header h1 {
                font-size: 36px;
            }

            .content {
                padding: 40px;
            }

            .timeline {
                padding: 25px;
            }

            .timeline-item {
                padding: 20px;
                margin-bottom: 20px;
            }

            .time-badge {
                font-size: 16px;
                padding: 8px 16px;
            }

            .activity-title {
                font-size: 19px;
            }

            .activity-detail {
                font-size: 15px;
                line-height: 1.8;
            }
        }

        /* 響應式設計 - 大螢幕 (1440px以上) */
        @media screen and (min-width: 1440px) {
            .container {
                max-width: 1200px;
            }

            .header h1 {
                font-size: 42px;
            }

            .content {
                padding: 50px;
            }
        }

        /* 小螢幕優化 (480px以下) */
        @media screen and (max-width: 480px) {
            body {
                padding: 5px;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 20px;
            }

            .header .subtitle {
                font-size: 12px;
            }

            .nav-tab {
                font-size: 12px;
                padding: 12px 8px;
                min-width: 70px;
            }

            .content {
                padding: 15px;
            }

            .day-number {
                font-size: 28px;
                width: 50px;
                height: 50px;
            }

            .day-date {
                font-size: 14px;
            }

            .day-location {
                font-size: 13px;
            }

            .timeline-item {
                padding: 12px;
            }

            .time-badge {
                font-size: 12px;
                padding: 4px 10px;
            }

            .activity-title {
                font-size: 15px;
            }

            .activity-detail {
                font-size: 13px;
            }
        }

        /* 返回頂部按鈕 */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, background 0.3s;
            box-shadow: 0 4px 12px var(--shadow-color);
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 16px var(--shadow-color);
        }

        /* 超小螢幕 (360px以下) */
        @media screen and (max-width: 360px) {
            .header h1 {
                font-size: 18px;
            }

            .nav-tab {
                font-size: 11px;
                padding: 10px 6px;
                min-width: 60px;
            }

            .content {
                padding: 10px;
            }
        }

        /* ========== 響應式設計 - 新功能優化 ========== */

        /* 手機版 - 分享功能優化 */
        @media screen and (max-width: 768px) {
            .share-button,
            .theme-toggle {
                width: 36px;
                height: 36px;
                font-size: 18px;
            }

            .share-button {
                right: 55px;
            }

            .share-modal-content {
                width: 95%;
                padding: 20px;
                max-height: 85vh;
            }

            .share-modal-title {
                font-size: var(--font-size-h3);
            }

            .share-option-btn {
                padding: 12px 15px;
                gap: 12px;
            }

            .share-option-icon {
                font-size: 20px;
            }

            .share-option-label {
                font-size: var(--font-size-body);
            }

            .share-option-desc {
                font-size: var(--font-size-tiny);
            }

            .share-preview-content {
                font-size: var(--font-size-tiny);
                max-height: 150px;
            }
        }

        /* 手機版 - 搜尋與過濾優化 */
        @media screen and (max-width: 768px) {
            .search-container {
                padding: 12px;
                margin: -20px -20px 15px -20px;
            }

            .search-input {
                padding: 10px 35px 10px 12px;
                font-size: var(--font-size-small);
            }

            .clear-search {
                right: 10px;
                font-size: 18px;
            }

            .filter-container {
                gap: 8px;
                flex-wrap: wrap;
            }

            .filter-btn {
                padding: 8px 12px;
                font-size: var(--font-size-small);
                flex: 1;
                min-width: calc(50% - 4px);
            }

            .search-results-info {
                font-size: var(--font-size-tiny);
                padding: 6px 10px;
            }
        }

        /* 手機版 - 收藏與筆記優化 */
        @media screen and (max-width: 768px) {
            .item-actions {
                flex-direction: column;
                gap: 8px;
            }

            .favorite-btn,
            .note-btn {
                width: 100%;
                justify-content: center;
                font-size: var(--font-size-small);
            }

            .note-input {
                font-size: var(--font-size-small);
                padding: 8px 10px;
            }

            .note-actions {
                gap: 8px;
            }

            .note-save-btn,
            .note-cancel-btn {
                padding: 6px 12px;
                font-size: var(--font-size-small);
            }

            .note-display {
                font-size: var(--font-size-small);
                padding: 8px 10px;
            }
        }

        /* 手機版 - 餐廳卡片優化 */
        @media screen and (max-width: 768px) {
            .restaurant-card {
                padding: 15px;
            }

            .restaurant-name {
                font-size: var(--font-size-h3);
            }

            .restaurant-type {
                font-size: var(--font-size-tiny);
                padding: 4px 10px;
            }

            .restaurant-rating {
                font-size: var(--font-size-small);
            }

            .restaurant-info {
                font-size: var(--font-size-small);
            }

            .restaurant-highlight {
                font-size: var(--font-size-small);
                padding: 8px 12px;
            }
        }

        /* 小螢幕 - 進一步優化 */
        @media screen and (max-width: 480px) {
            .share-button {
                right: 50px;
                width: 32px;
                height: 32px;
                font-size: 16px;
            }

            .theme-toggle {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }

            .share-modal-content {
                padding: 15px;
                border-radius: 15px;
            }

            .share-option-btn {
                padding: 10px 12px;
                border-radius: 10px;
            }

            .share-success {
                font-size: var(--font-size-small);
                padding: 10px 20px;
                top: 10px;
            }

            .filter-btn {
                min-width: 100%;
                text-align: center;
            }

            .search-container {
                margin: -15px -15px 15px -15px;
                padding: 10px;
            }
        }

        /* 平板版 - 優化佈局 */
        @media screen and (min-width: 768px) and (max-width: 1024px) {
            .restaurant-card {
                padding: 20px;
            }

            .search-container {
                padding: 15px 20px;
            }

            .filter-btn {
                flex: 0 0 auto;
                min-width: 100px;
            }

            .item-actions {
                flex-direction: row;
            }
        }

        /* 桌機版 - 分享彈窗置中優化 */
        @media screen and (min-width: 1024px) {
            .share-modal-content {
                max-width: 550px;
                padding: 35px;
            }

            .share-option-btn:hover {
                transform: translateX(8px);
            }
        }

        /* 橫向模式優化 (手機橫放) */
        @media screen and (max-width: 768px) and (orientation: landscape) {
            .share-modal-content {
                max-height: 90vh;
                overflow-y: auto;
            }

            .header {
                padding: 15px 20px;
            }

            .day-header {
                padding: 15px 20px;
            }
        }

        /* 高解析度螢幕優化 */
        @media screen and (min-width: 1440px) {
            .share-modal-content {
                max-width: 600px;
                padding: 40px;
            }

            .share-option-btn {
                padding: 18px 24px;
            }

            .share-option-icon {
                font-size: 28px;
            }
        }

        /* 觸控優化 - 增加點擊區域 */
        @media (hover: none) and (pointer: coarse) {
            .share-button,
            .theme-toggle,
            .favorite-btn,
            .note-btn,
            .filter-btn,
            .clear-search,
            .timeline-toggle-btn {
                min-height: 44px;
                min-width: 44px;
            }

            .share-option-btn {
                min-height: 56px;
            }

            .nav-tab {
                min-height: 44px;
            }

            .timeline-control-btn {
                min-height: 44px;
            }
        }

        /* 手機版 - 時間軸控制優化 */
        @media screen and (max-width: 768px) {
            .timeline-controls {
                gap: 8px;
            }

            .timeline-control-btn {
                padding: 6px 12px;
                font-size: var(--font-size-tiny);
                flex: 1;
            }

            .timeline-toggle-btn {
                font-size: 16px;
                padding: 4px 8px;
            }

            .timeline-header {
                gap: 8px;
            }
        }

        @media screen and (max-width: 480px) {
            .timeline-controls {
                flex-direction: column;
            }

            .timeline-control-btn {
                width: 100%;
            }

            /* 提醒面板手機版適配 */
            .alerts-panel {
                width: 100%;
                right: -100%;
            }

            .floating-alerts-btn {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .floating-alerts-btn .badge-count {
                width: 20px;
                height: 20px;
                font-size: 10px;
            }

            .summary-items {
                gap: 6px;
            }

            .summary-item {
                font-size: 12px;
                padding: 5px 10px;
            }
        }

        /* 實用類別 - 處理深色模式 */
        body.dark-mode div[style*="background: white"],
        body.dark-mode div[style*="background: #fff"],
        body.dark-mode div[style*="background:#fff"] {
            background: var(--info-bg) !important;
        }

        body.dark-mode div[style*="background: #f0f0f0"],
        body.dark-mode div[style*="background:#f0f0f0"] {
            background: var(--highlight-bg) !important;
        }

        body.dark-mode div[style*="background: #e3f2fd"],
        body.dark-mode div[style*="background:#e3f2fd"] {
            background: var(--info-light-bg) !important;
        }

        body.dark-mode div[style*="background: #fff3e0"],
        body.dark-mode div[style*="background:#fff3e0"] {
            background: var(--orange-bg) !important;
        }

        body.dark-mode div[style*="background: #d4edda"],
        body.dark-mode div[style*="background:#d4edda"] {
            background: var(--success-bg) !important;
        }

        body.dark-mode div[style*="background: #fff3cd"],
        body.dark-mode div[style*="background:#fff3cd"] {
            background: var(--warning-bg) !important;
        }

        body.dark-mode div[style*="background: #e1f5fe"],
        body.dark-mode div[style*="background:#e1f5fe"] {
            background: var(--light-blue-bg) !important;
        }

        body.dark-mode div[style*="background: #e8f5e9"],
        body.dark-mode div[style*="background:#e8f5e9"] {
            background: var(--light-green-bg) !important;
        }

        body.dark-mode div[style*="background: #f3e5f5"],
        body.dark-mode div[style*="background:#f3e5f5"] {
            background: var(--purple-bg) !important;
        }

        body.dark-mode div[style*="background: #fce4ec"],
        body.dark-mode div[style*="background:#fce4ec"] {
            background: var(--pink-bg) !important;
        }

        body.dark-mode div[style*="background: #fff9c4"],
        body.dark-mode div[style*="background:#fff9c4"] {
            background: var(--yellow-bg) !important;
        }

        body.dark-mode div[style*="background: #f8d7da"],
        body.dark-mode div[style*="background:#f8d7da"],
        body.dark-mode div[style*="background: #ffebee"],
        body.dark-mode div[style*="background:#ffebee"] {
            background: #4a1e1e !important;
        }

        body.dark-mode span[style*="background"] {
            background: var(--highlight-bg) !important;
        }

        /* 微互動動畫效果 */
        @keyframes checkboxCelebration {
            0% { transform: scale(1); }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        .checkbox:checked {
            animation: checkboxCelebration 0.3s ease;
        }

        .checklist-item:has(.checkbox:checked) {
            animation: slideInSuccess 0.3s ease;
        }

        @keyframes slideInSuccess {
            0% { transform: translateX(0); background: var(--info-bg); }
            50% { transform: translateX(5px); background: var(--success-bg); }
            100% { transform: translateX(0); background: var(--info-bg); }
        }

        .day-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px var(--shadow-color);
        }

        .restaurant-card:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 16px var(--shadow-color);
        }

        /* 餐廳卡片摺疊功能 */
        .restaurant-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
            margin-bottom: 10px;
        }

        .restaurant-basic-info {
            flex: 1;
        }

        .restaurant-expand-btn {
            background: var(--schedule-primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .restaurant-expand-btn:hover {
            background: var(--schedule-dark);
            transform: scale(1.05);
        }

        .restaurant-expand-btn .icon {
            transition: transform 0.3s ease;
        }

        .restaurant-card.expanded .restaurant-expand-btn .icon {
            transform: rotate(180deg);
        }

        .restaurant-detail {
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease, margin-top 0.3s ease;
            max-height: 0;
            opacity: 0;
            margin-top: 0;
        }

        .restaurant-card.expanded .restaurant-detail {
            max-height: 500px;
            opacity: 1;
            margin-top: 10px;
        }

        .restaurant-summary {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 8px;
        }

        .restaurant-tag {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 12px;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            color: var(--text-color);
        }

        .restaurant-tag.booking-required {
            background: rgba(220, 53, 69, 0.1);
            border-color: rgba(220, 53, 69, 0.3);
            color: #dc3545;
        }

        .restaurant-tag.no-booking {
            background: rgba(40, 167, 69, 0.1);
            border-color: rgba(40, 167, 69, 0.3);
            color: #28a745;
        }

        /* 時間軸摺疊功能 */
        .timeline-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
            margin-bottom: 8px;
        }

        .timeline-basic {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .timeline-expand-btn {
            background: #e0e0e0;
            color: #333;
            border: none;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            flex-shrink: 0;
        }

        .timeline-expand-btn:hover {
            background: #d0d0d0;
        }

        .timeline-expand-btn .icon {
            transition: transform 0.3s ease;
            font-size: 10px;
        }

        .timeline-item.expanded .timeline-expand-btn .icon {
            transform: rotate(180deg);
        }

        .timeline-detail {
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease, margin-top 0.3s ease;
            max-height: 0;
            opacity: 0;
            margin-top: 0;
        }

        .timeline-item.expanded .timeline-detail {
            max-height: 800px;
            opacity: 1;
            margin-top: 8px;
        }

        /* 重要度標記 */
        .importance-badge {
            display: inline-flex;
            align-items: center;
            gap: 3px;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            margin-left: 8px;
            white-space: nowrap;
        }

        .importance-must {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(255, 107, 107, 0.3);
        }

        .importance-recommend {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(79, 172, 254, 0.3);
        }

        .importance-optional {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #666;
            box-shadow: 0 2px 4px rgba(168, 237, 234, 0.3);
        }

        button {
            position: relative;
            overflow: hidden;
        }

        button::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        button:active::after {
            width: 300px;
            height: 300px;
        }

        .nav-tab {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-tab:hover {
            transform: translateY(-2px);
        }

        .nav-tab:active {
            transform: translateY(0);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .back-to-top {
            animation: float 2s ease-in-out infinite;
        }

        @keyframes progressGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(74, 222, 128, 0.5); }
            50% { box-shadow: 0 0 20px rgba(74, 222, 128, 0.8); }
        }

        .progress-bar-fill[style*="100%"] {
            animation: progressGlow 1.5s ease-in-out infinite;
        }

        /* 載入動畫 */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section {
            animation: fadeInUp 0.5s ease-out;
        }

        /* 快速跳轉選單 */
        .quick-nav {
            position: fixed;
            bottom: 90px;
            right: 30px;
            z-index: 998;
        }

        .quick-nav-toggle {
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px var(--shadow-color);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quick-nav-toggle:hover {
            transform: rotate(90deg) scale(1.1);
        }

        .quick-nav-menu {
            position: absolute;
            bottom: 60px;
            right: 0;
            background: var(--container-bg);
            border-radius: 15px;
            padding: 10px;
            box-shadow: 0 8px 24px var(--shadow-color);
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
            min-width: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .quick-nav-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .quick-nav-item {
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-color);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-nav-item:hover {
            background: var(--highlight-bg);
            transform: translateX(-5px);
        }

        .quick-nav-item.active {
            background: var(--bg-gradient-start);
            color: white;
        }

        /* 搜尋與過濾系統 */
        .search-container {
            position: sticky;
            top: 0;
            z-index: 99;
            background: var(--container-bg);
            padding: 15px;
            border-bottom: 2px solid var(--border-color);
            box-shadow: 0 2px 8px var(--shadow-color);
            margin: -20px -20px 20px -20px;
        }

        .search-box {
            position: relative;
            margin-bottom: 10px;
        }

        .search-input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 15px;
            background: var(--info-bg);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--bg-gradient-start);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-input::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            color: var(--text-secondary);
            pointer-events: none;
        }

        .clear-search {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            font-size: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 5px;
            display: none;
            transition: color 0.3s ease;
        }

        .clear-search:hover {
            color: var(--text-color);
        }

        .clear-search.show {
            display: block;
        }

        .filter-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 6px 15px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            background: var(--info-bg);
            color: var(--text-color);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .filter-btn:hover {
            border-color: var(--bg-gradient-start);
            color: var(--bg-gradient-start);
            transform: translateY(-1px);
        }

        .filter-btn.active {
            background: var(--bg-gradient-start);
            border-color: var(--bg-gradient-start);
            color: white;
            font-weight: 600;
        }

        .search-results-info {
            margin-top: 10px;
            padding: 8px 12px;
            background: var(--tip-light);
            border-left: 3px solid var(--tip-primary);
            border-radius: 5px;
            font-size: 13px;
            display: none;
        }

        .search-results-info.show {
            display: block;
        }

        .highlight {
            background: #ffeb3b;
            color: #000;
            font-weight: 600;
            padding: 0 2px;
            border-radius: 2px;
        }

        body.dark-mode .highlight {
            background: #ffc107;
            color: #000;
        }

        .search-no-results {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .search-no-results-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        /* 收藏與筆記系統 */
        .item-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
        }

        .favorite-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
            position: relative;
        }

        .favorite-btn:hover {
            background: var(--highlight-bg);
            transform: scale(1.1);
        }

        .favorite-btn.favorited {
            color: #ffc107;
            animation: starPulse 0.5s ease;
        }

        @keyframes starPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }

        .note-btn {
            background: var(--highlight-bg);
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-color);
        }

        .note-btn:hover {
            background: var(--bg-gradient-start);
            color: white;
        }

        .note-btn.has-note {
            background: var(--bg-gradient-start);
            color: white;
        }

        .note-container {
            margin-top: 10px;
            padding: 10px;
            background: var(--info-bg);
            border-radius: 8px;
            border: 1px solid var(--border-color);
            display: none;
        }

        .note-container.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .note-textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            background: var(--container-bg);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .note-textarea:focus {
            outline: none;
            border-color: var(--bg-gradient-start);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .note-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: flex-end;
        }

        .note-save-btn, .note-cancel-btn {
            padding: 6px 15px;
            border: none;
            border-radius: 5px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .note-save-btn {
            background: var(--bg-gradient-start);
            color: white;
        }

        .note-save-btn:hover {
            background: var(--bg-gradient-end);
            transform: translateY(-1px);
        }

        .note-cancel-btn {
            background: var(--highlight-bg);
            color: var(--text-color);
        }

        .note-cancel-btn:hover {
            background: var(--border-color);
        }

        .note-display {
            padding: 10px;
            background: var(--tip-light);
            border-left: 3px solid var(--tip-primary);
            border-radius: 5px;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            margin-bottom: 10px;
        }

        .note-edit-btn {
            font-size: 12px;
            padding: 4px 10px;
            background: none;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .note-edit-btn:hover {
            background: var(--highlight-bg);
            color: var(--text-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="share-button" onclick="openShareModal()" aria-label="分享旅遊指南">
                <span>📤</span>
            </button>
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="切換深色模式">
                <span id="theme-icon">🌙</span>
            </button>
            <h1>🗾 北海道家庭之旅</h1>
            <div class="subtitle">2025.10.11 - 10.18｜4人同行</div>

            <!-- 整體進度條 -->
            <div class="progress-container">
                <div class="progress-label">
                    <span>整體進度</span>
                    <span id="overall-progress-text">0%</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="overall-progress-bar" style="width: 0%"></div>
                </div>
            </div>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('prepare')">📋 行前準備</button>
            <button class="nav-tab" onclick="showSection('transport')">🚃 交通指南</button>
            <button class="nav-tab" onclick="showSection('day1')">Day 1</button>
            <button class="nav-tab" onclick="showSection('day2')">Day 2</button>
            <button class="nav-tab" onclick="showSection('day3')">Day 3</button>
            <button class="nav-tab" onclick="showSection('day4')">Day 4</button>
            <button class="nav-tab" onclick="showSection('day5')">Day 5</button>
            <button class="nav-tab" onclick="showSection('day6')">Day 6</button>
            <button class="nav-tab" onclick="showSection('day7')">Day 7</button>
            <button class="nav-tab" onclick="showSection('day8')">Day 8</button>
            <button class="nav-tab" onclick="showSection('restaurants')">🍜 美食</button>
            <button class="nav-tab" onclick="showSection('emergency')">🆘 緊急</button>
        </div>
        
        <div class="content">
            <!-- 行前準備 -->
            <div class="section active" id="prepare">
                <div class="checklist">
                    <div class="checklist-title">📦 必帶物品清單</div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>護照（確認效期6個月以上）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>機票列印本 x4份</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>飯店預訂確認單</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>現金日幣（建議每人8萬円）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>信用卡2-3張（JCB/VISA優先）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>行動電源 & 充電線</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>保暖外套（10月均溫10-18°C）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>防風防水外套</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>舒適好走的鞋子</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>個人藥品 & 胃藥</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>雨傘或輕便雨衣</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>環保購物袋（日本要收塑膠袋費）</span>
                    </div>
                </div>
                
                <div class="checklist">
                    <div class="checklist-title">👔 10月中旬穿著建議（10-18°C）</div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>長袖上衣 x3-4件</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>薄毛衣或針織衫 x2件</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>防風外套 x1件（必備）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>輕羽絨外套（早晚較冷）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>長褲 x3-4件</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>圍巾（函館山必備）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>好走的鞋子 x2雙</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>雨傘或輕便雨衣</span>
                    </div>
                </div>
                
                <div class="checklist">
                    <div class="checklist-title">📱 必裝APP</div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>Google Maps（下載北海道離線地圖）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>乘換案內（交通查詢神器）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>Google翻譯（下載日文離線包）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>Tabelog（餐廳評價）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>PayPay（部分店家可用）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>tenki.jp（天氣預報）</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span>Currency（匯率換算）</span>
                    </div>
                </div>
                
                <div class="checklist">
                    <div class="checklist-title">🌡️ 10月北海道天氣</div>
                    <div style="padding: 15px; background: white; border-radius: 8px;">
                        <div style="margin-bottom: 10px;">
                            <b>札幌：</b><br>
                            • 平均溫度：12°C<br>
                            • 最高/最低：16°C / 8°C<br>
                            • 降雨日：約8-10天
                        </div>
                        <div style="margin-bottom: 10px;">
                            <b>函館：</b><br>
                            • 平均溫度：13°C<br>
                            • 最高/最低：17°C / 9°C<br>
                            • 函館山頂會低5-8度
                        </div>
                        <div>
                            <b>特別提醒：</b><br>
                            • 早晚溫差大（可達10度）<br>
                            • 洋蔥式穿法最實用<br>
                            • 10月中開始楓葉轉紅
                        </div>
                    </div>
                </div>
                
                <div class="tip-box">
                    <div class="tip-title">💡 重要提醒</div>
                    <div>• 10/10晚上記得線上check-in</div>
                    <div>• 準備小額日幣（100、500円硬幣）給販賣機用</div>
                    <div>• JR Pass建議抵達機場後立即購買</div>
                    <div>• 隨身攜帶護照，部分免稅店需要</div>
                    <div><b>• 餐廳預約：請在出發前2週完成</b></div>
                    <div><b>• 日本時間比台灣快1小時</b></div>
                    <div><b>• 插頭相同不需轉接頭</b></div>
                </div>
                
                <div class="transport-info">
                    <div class="transport-title">🎫 交通票券速覽</div>

                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <tr style="background: white;">
                                <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;"><b>票券名稱</b></td>
                                <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;"><b>價格</b></td>
                                <td style="padding: 10px; border-bottom: 1px solid #e0e0e0;"><b>使用日期</b></td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">JR Pass 5日券</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">¥22,000</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">Day 3-7</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">函館市電一日券</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">¥1,200</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">Day 5-6</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">ICOCA 儲值</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">¥3,000</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">Day 1, 2, 8</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">機場交通（來回）</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">¥2,300</td>
                                <td style="padding: 10px; border-bottom: 1px solid #f0f0f0;">Day 1, 8</td>
                            </tr>
                            <tr style="background: #c8e6c9; font-weight: bold;">
                                <td style="padding: 12px;">總計（每人）</td>
                                <td style="padding: 12px;" colspan="2">¥28,500</td>
                            </tr>
                        </table>
                        <div style="margin-top: 10px; font-size: 13px; color: #666;">
                            💡 詳細購買與使用說明請參考 <b>🚃 交通指南</b> 分頁
                        </div>
                    </div>
                </div>
                
                <div class="checklist" style="margin-top: 20px;">
                    <div class="checklist-title">📝 餐廳預約清單（出發前完成）</div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span><b>Day 1 晚餐</b> - かに將軍（螃蟹料理）⭐ 需預約</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span><b>Day 3 午餐</b> - 政壽司（選擇性）⭐ 建議預約</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span><b>Day 4 晚餐</b> - 幸運小丑漢堡 ✅ 無需預約</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span><b>Day 5 晚餐</b> - 函太郎迴轉壽司 ✅ 無需預約</span>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" class="checkbox">
                        <span><b>Day 6 午餐</b> - 海鮮處花月 ⭐ 建議預約</span>
                    </div>
                    <div style="margin-top: 10px; padding: 10px; background: #fff3e0; border-radius: 5px; font-size: 13px;">
                        💡 詳細餐廳資訊（電話、地址、預約方式）請參考 <b>🍜 美食</b> 分頁
                    </div>
                </div>
                
                <div class="tip-box" style="margin-top: 15px;">
                    <div class="tip-title">📱 預約日文範本</div>
                    <div style="font-size: 13px; background: #f0f0f0; padding: 10px; border-radius: 5px;">
                        <b>電話預約（請飯店協助）：</b><br>
                        10月11日（土）18時<br>
                        4名<br>
                        禁煙席（きんえんせき）<br>
                        預約名：您的英文姓名<br><br>
                        
                        <b>取消預約：</b><br>
                        キャンセルしたいです<br>
                        (Kyanseru shitai desu)
                    </div>
                </div>
            </div>

            <!-- 交通指南 -->
            <div class="section" id="transport">
                <h2>🚃 交通指南</h2>

                <div style="background: #e3f2fd; border: 2px solid #2196f3; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🎫 JR北海道鐵路周遊券（JR Pass）</div>
                    <div style="font-size: 14px;">
                        <b>使用期限：</b>連續7天<br>
                        <b>適用範圍：</b>北海道全域JR列車（含特急指定席）<br>
                        <b>不適用：</b>北海道新幹線、道南いさりび鐵道<br><br>

                        <b style="color: #d32f2f;">⚠️ 重要：</b>必須在抵達日本前購買兌換券<br>
                        <b>兌換地點：</b>新千歲機場JR外籍旅客服務中心<br>
                        <b>營業時間：</b>08:30-19:00<br><br>

                        <b>📍 兌換步驟：</b><br>
                        1. 機場B1F JR服務中心<br>
                        2. 出示護照+兌換券<br>
                        3. 告知開始使用日期（建議第一天就開始）<br>
                        4. 填寫使用者資訊<br>
                        5. 領取JR Pass實體票<br><br>

                        <b>💡 使用技巧：</b><br>
                        • 搭乘特急列車務必劃指定席<br>
                        • 熱門時段提早劃位（函館、旭川方向）<br>
                        • 進出車站走人工閘口，出示Pass<br>
                        • 可無限次免費劃位，不滿意可重劃
                    </div>
                </div>

                <div style="background: #f3e5f5; border: 2px solid #9c27b0; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🎟️ 指定席劃位教學</div>
                    <div style="font-size: 14px;">
                        <b>劃位地點：</b>JR綠色窗口（みどりの窓口）<br><br>

                        <b>📋 建議提前劃好的車次：</b><br>
                        ✅ Day 3：札幌→洞爺（特急北斗號）<br>
                        ✅ Day 5：洞爺→函館（特急北斗號）<br>
                        ✅ Day 7：函館→札幌（特急北斗號）<br><br>

                        <b>🗣️ 劃位日文範例：</b><br>
                        「指定席をお願いします」<br>
                        (Shitei-seki wo onegai shimasu)<br><br>

                        出示手機備忘錄：<br>
                        • 日期：10月13日<br>
                        • 路線：札幌→洞爺<br>
                        • 人數：4名<br>
                        • 時間：13:30左右<br>
                        • 座位：窗側（まどがわ）<br><br>

                        <b>💡 座位選擇技巧：</b><br>
                        • 札幌→洞爺：右側可看羊蹄山<br>
                        • 洞爺→函館：左側海景<br>
                        • 函館→札幌：左側海景
                    </div>
                </div>

                <div style="background: #fff3e0; border: 2px solid #ff9800; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🚇 札幌市內交通</div>
                    <div style="font-size: 14px;">
                        <b>地下鐵一日券：</b>¥830（週六日&假日）/ ¥870（平日）<br>
                        <b>購買地點：</b>地下鐵各站售票機<br>
                        <b>使用範圍：</b>札幌市營地下鐵全線（3條線）<br><br>

                        <b>📍 主要路線：</b><br>
                        🔴 南北線：札幌站⇄薄野⇄中島公園<br>
                        🟢 東西線：圓山公園⇄大通⇄バスセンター前<br>
                        🟠 東豐線：札幌站⇄大通⇄福住<br><br>

                        <b>🚌 路面電車（市電）：</b><br>
                        • 單程：¥200<br>
                        • 一日券：¥380（不常用，因景點集中）<br>
                        • 狸小路、薄野都在步行範圍<br><br>

                        <b>💡 省錢技巧：</b><br>
                        • 札幌市區景點多數步行可達<br>
                        • 地下鐵主要用於往返新札幌、圓山<br>
                        • Day 2建議購買一日券（會多次搭乘）
                    </div>
                </div>

                <div style="background: #e8f5e9; border: 2px solid #4caf50; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🚋 函館市電</div>
                    <div style="font-size: 14px;">
                        <b>市電一日券：</b>¥600（無限次搭乘）<br>
                        <span style="background: #fff3e0; padding: 3px 8px; border-radius: 3px; display: inline-block; margin: 5px 0;">
                        ⚠️ <b>2025年12月1日起調漲至¥800</b>（您的旅行日期仍為¥600）</span><br>
                        <b>購買地點：</b>函館站觀光案內所、車上跟司機購買<br>
                        <b>使用方式：</b>下車時出示給司機看日期即可<br><br>

                        <b>📍 主要站點：</b><br>
                        • 函館站前 → 十字街（金森倉庫）<br>
                        • 函館站前 → 五稜郭公園前<br>
                        • 函館站前 → 谷地頭（湯之川溫泉方向）<br>
                        • 末廣町（元町教會群）<br><br>

                        <b>🎫 單程 vs 一日券：</b><br>
                        單程：¥210-250<br>
                        搭3次以上就划算買一日券<br><br>

                        <b>🎟️ 其他票券選項：</b><br>
                        • 市電+巴士共通1日券：¥1,400<br>
                        • 市電+巴士共通2日券：¥2,400<br>
                        💡 本行程市電已足夠，<b>不需買共通券</b><br><br>

                        <b>💡 使用建議：</b><br>
                        • Day 5、Day 6必買一日券<br>
                        • 車上有路線圖，不用擔心坐錯<br>
                        • 後門上車、前門下車付費<br>
                        • 下車按鈴：降りますボタン<br>
                        • 可用IC卡（Suica、Kitaca）但無折扣
                    </div>
                </div>

                <div style="background: #fce4ec; border: 2px solid #e91e63; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🚌 巴士交通</div>
                    <div style="font-size: 14px;">
                        <b>機場巴士直達服務：</b><br>
                        <span style="background: #fff; padding: 5px 8px; border-radius: 3px; display: inline-block; margin: 5px 0;">
                        🚌 新千歲機場→札幌市區：¥1,300（約70分鐘）</span><br>
                        <span style="background: #fff; padding: 5px 8px; border-radius: 3px; display: inline-block; margin: 5px 0;">
                        🚌 新千歲機場→小樽：¥2,300（約100分鐘）</span><br>
                        • 可使用信用卡付款<br>
                        • 機場國內線&國際線都有巴士站<br>
                        • 有行李放置空間<br>
                        💡 <b>建議：</b>搭JR較快（37分鐘），且JR Pass免費<br><br>

                        <b>新千歲機場 ⇄ 札幌：</b><br>
                        推薦搭JR快速Airport（用JR Pass免費）<br>
                        • 車程：37分鐘<br>
                        • 班次：15分鐘一班<br>
                        • 大件行李可放置物區<br><br>

                        <b>札幌 ⇄ 函館高速巴士：</b><br>
                        • 車資：¥3,820-5,360（比JR便宜但很慢）<br>
                        • 車程：約5小時15分（夏）/ 5小時35分（冬）<br>
                        💡 <b>不推薦：</b>JR特急只要3.5小時且更舒適<br><br>

                        <b>JR洞爺站 ⇄ 洞爺湖溫泉街：</b><br>
                        道南巴士：¥340 / 20分鐘<br>
                        • 配合JR時刻表發車<br>
                        • 班次較少，建議查好時間<br>
                        • 或詢問飯店接駁巴士<br><br>

                        <b>小樽市內：</b><br>
                        不需搭巴士，景點集中步行即可<br>
                        JR小樽站→運河：步行10分鐘<br><br>

                        <b>💡 查詢工具：</b><br>
                        • Google Maps（即時班次）<br>
                        • 北海道中央巴士官網<br>
                        • 道南巴士官網
                    </div>
                </div>

                <div style="background: #f3e5f5; border: 2px solid #9c27b0; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🎫 北海道巴士周遊券（進階選項）</div>
                    <div style="font-size: 14px;">
                        <b style="color: #9c27b0;">⚠️ 本行程不需購買（已有JR Pass更划算）</b><br><br>

                        <b>1️⃣ Hokkaido Inter City Bus Pass (ICBP)</b><br>
                        • 3日券 / 5日券<br>
                        • 涵蓋：札幌周邊、小樽、二世谷、洞爺湖<br>
                        • 適合：不買JR Pass的自由行旅客<br><br>

                        <b>2️⃣ Hokkaido Budget Bus Pass (HBBP)</b><br>
                        • 3日券 / 5日券<br>
                        • 涵蓋範圍更廣：函館、旭川、釧路、網走<br>
                        • 適合：環北海道深度遊<br><br>

                        <b>3️⃣ Hokkaido Resort Liner（度假村接駁）</b><br>
                        📞 +81-11-200-0506<br>
                        🌐 www.access-n.jp/resortliner_eng/<br>
                        • 路線：札幌/新千歲↔二世谷、洞爺湖、留壽都<br>
                        • <b style="color: #d32f2f;">需提前9天預約</b><br>
                        • 適合：滑雪季或度假村住宿<br><br>

                        💡 <b>判斷標準：</b><br>
                        • 有JR Pass → 不需要巴士券<br>
                        • 只玩札幌小樽 → 考慮ICBP<br>
                        • 環島深度遊 → 考慮HBBP
                    </div>
                </div>

                <div style="background: #e8f5e9; border: 2px solid #4caf50; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🎟️ 定期觀光巴士（一日遊選項）</div>
                    <div style="font-size: 14px;">
                        <b>札幌定期觀光巴士（北海道中央巴士）</b><br><br>

                        <b>🍰 A路線｜白色戀人公園+場外市場+大倉山</b><br>
                        • 時間：4小時（上午出發）<br>
                        • 多語音導覽（日英中韓）<br>
                        • 適合不想自己轉車的旅客<br>
                        💡 本行程Day 2已安排自行前往，<b>不需參加</b><br><br>

                        <b>🏔️ 洞爺湖周遊巴士</b><br>
                        • 路線：昭和新山、熊牧場、有珠山纜車<br>
                        • 本行程Day 4已有安排，<b>不需額外參加</b><br><br>

                        <b>🦀 函館定期觀光巴士</b><br>
                        • 函館朝市、五稜郭、元町、函館山<br>
                        • 本行程已細緻規劃，<b>更推薦自由行</b><br><br>

                        💡 <b>總結：</b>定期觀光巴士適合趕時間或不想規劃的旅客，<br>
                        但您的行程已經很完善，<b>建議按原計劃自由行更彈性</b>
                    </div>
                </div>

                <div style="background: #fff9c4; border: 2px solid #fbc02d; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">📱 實用交通APP</div>
                    <div style="font-size: 14px;">
                        <b>🔥 必裝：</b><br><br>

                        <b>1. 乘換案內（Jorudan）</b><br>
                        • 日本最準確的交通查詢<br>
                        • 可查JR、地下鐵、巴士<br>
                        • 顯示月台號碼、車資<br>
                        • 有中文版但建議用日文版較準<br><br>

                        <b>2. Google Maps</b><br>
                        • 步行導航很準確<br>
                        • 即時路線建議<br>
                        • 可離線下載地圖<br><br>

                        <b>3. JR北海道官方APP</b><br>
                        • 查詢列車時刻表<br>
                        • 運行狀況通知<br>
                        • 冬季延誤資訊<br><br>

                        <b>4. 函館市電MAP</b><br>
                        • 函館路面電車路線<br>
                        • 觀光景點標示<br><br>

                        <b>💡 離線準備：</b><br>
                        • 出發前下載Google離線地圖<br>
                        • 截圖重要車次時刻表<br>
                        • 備份飯店地址日文版
                    </div>
                </div>

                <div style="background: #e1f5fe; border: 2px solid #03a9f4; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px; font-size: 18px;">🎒 行李寄存</div>
                    <div style="font-size: 14px;">
                        <b>車站置物櫃：</b><br>
                        • 小型（S）：¥300-400<br>
                        • 中型（M）：¥500-600<br>
                        • 大型（L）：¥700-800<br>
                        • 特大：¥1,000<br><br>

                        <b>📍 主要車站置物櫃位置：</b><br><br>

                        <b>札幌站：</b><br>
                        • 西口、東口、南口都有<br>
                        • 大型櫃較少，早上先放<br>
                        • 24小時使用，隔天加收一天費用<br><br>

                        <b>函館站：</b><br>
                        • 1F、2F都有置物櫃<br>
                        • 觀光案內所旁最多<br><br>

                        <b>小樽站：</b><br>
                        • 改札口內外都有<br>
                        • 建議用站外的（進出方便）<br><br>

                        <b>💡 使用技巧：</b><br>
                        • 拍照記錄櫃號和位置<br>
                        • 準備零錢（¥100硬幣）<br>
                        • 滿櫃時詢問站務員其他位置<br>
                        • Day 3去小樽建議用置物櫃<br><br>

                        <b>🏨 飯店寄放：</b><br>
                        • 退房後可免費寄放到晚上<br>
                        • 記得索取寄物證明<br>
                        • 建議用此服務取代置物櫃
                    </div>
                </div>

                <div class="tip-box">
                    <div class="tip-title">💡 交通省錢技巧</div>
                    <div>• JR Pass一定要買，光札幌⇄函館來回就值回票價</div>
                    <div>• 札幌市區多走路，地下鐵其實用不多</div>
                    <div>• 函館一定要買市電一日券（¥600超划算）</div>
                    <div>• 小樽不用買任何票券，全程步行</div>
                    <div>• 提早劃位可選好座位看風景</div>
                    <div>• 下載離線地圖避免迷路</div>
                </div>

                <div class="tip-box" style="background: #ffebee; border: 2px solid #f44336;">
                    <div class="tip-title">⚠️ 注意事項</div>
                    <div>• 10月中北海道可能下雪，列車可能延誤</div>
                    <div>• JR Pass不能搭北海道新幹線</div>
                    <div>• 特急列車一定要劃指定席，自由席可能沒位</div>
                    <div>• 週末函館山纜車大排隊，建議提早上山</div>
                    <div>• 冬季日落早（16:30左右），安排行程要注意</div>
                    <div>• 帶暖暖包，車站月台很冷</div>
                </div>
            </div>

            <!-- Day 1 -->
            <div class="section" id="day1">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">1</div>
                        <div class="day-title">
                            <div class="day-date">10月11日 星期六</div>
                            <div class="day-location">✈️ 抵達札幌</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">✈️ 抵達新千歲機場</div>
                                    <div class="summary-item">🏨 入住札幌飯店</div>
                                    <div class="summary-item">🛍️ 狸小路商店街</div>
                                    <div class="summary-item">🦀 かに將軍晚餐</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• 05:00 從家出發去機場</div>
                                    <div>• 機場購買 ICOCA ¥2,000 + JR Pass ¥22,000</div>
                                    <div>• かに將軍建議提前預約（17:30）</div>
                                    <div>• 狸小路商店街營業至 21:00</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d1-activity-1">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge">06:20</span>
                                    <div class="activity-title">桃園機場集合</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                第二航廈3樓虎航櫃檯<br>
                                <span class="transport-badge">🚕 建議05:00從家出發</span>
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">08:20</span>
                                    <div class="activity-title">起飛前往札幌</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                航班：IT234 虎航<br>
                                飛行時間：約3小時45分
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:05</span>
                                    <div class="activity-title">抵達新千歲機場</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                • 入境審查（準備護照）<br>
                                • 領取行李（拍照記錄轉盤號碼）<br>
                                • 兌換JR Pass（B1樓JR服務中心 08:30-19:00）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-4" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">機場 → 札幌</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b>📍 機場任務：</b><br>
                                1️⃣ 兌換 JR Pass（10/13 開始使用，可預約 Day 3-7 指定席）<br>
                                2️⃣ ICOCA 儲值 ¥3,000/人<br><br>

                                <b>🚃 JR 快速 Airport：</b>¥1,150（37分鐘）<br>
                                <div style="background: #fff3e0; padding: 8px; border-radius: 5px; margin-top: 8px;">
                                    <b>💡 為何不用 JR Pass？</b><br>
                                    今天單程用 ICOCA 即可，JR Pass 從 10/13 開始用最划算
                                </div>
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:00</span>
                                    <div class="activity-title">機場簡便午餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🍱 機場便當或輕食</span><br>
                                預算：¥800/人 | 快速用餐，留肚子給市區美食！
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">13:00</span>
                                    <div class="activity-title">前往札幌市區</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚃 JR快速Airport</span><br>
                                ICOCA 刷卡進站 | 注意搭乘「快速」而非「普通」
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">14:00</span>
                                    <div class="activity-title">飯店寄放行李</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                札幌格蘭大酒店（札幌站南口步行5分鐘）<br>
                                ⚠️ 正式 Check-in：15:00（先寄放行李即可）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:00</span>
                                    <div class="activity-title">大通公園散步</div>
                                    <span class="importance-badge importance-recommend">⭐⭐ 推薦</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚶 步行5分鐘</span><br>
                                電視塔：¥1,000（選） | 烤玉米：¥300（推薦）<br>
                                💡 輕鬆散步即可，保留胃口給晚上螃蟹料理
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-9">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-9')">
                                <div class="timeline-basic">
                                    <span class="time-badge">16:30</span>
                                    <div class="activity-title">回飯店 Check-in & 休息</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                辦理入住、稍作休息
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-10">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-10')">
                                <div class="timeline-basic">
                                    <span class="time-badge">18:30</span>
                                    <div class="activity-title">晚餐：かに將軍（螃蟹料理）</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🦀 螃蟹會席</span><br>
                                預算：¥4,000-6,000/人 | ⭐ 需預約<br>
                                💡 詳細資訊請參考 <b>🍜 美食</b> 分頁
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d1-activity-11">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d1-activity-11')">
                                <div class="timeline-basic">
                                    <span class="time-badge">20:30</span>
                                    <div class="activity-title">狸小路購物</div>
                                    <span class="importance-badge importance-optional">⭐ 可選</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                藥妝店、唐吉訶德（24h）| 記得帶護照退稅<br>
                                💡 可買宵夜、隔天早餐
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Day 2 -->
            <div class="section" id="day2">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">2</div>
                        <div class="day-title">
                            <div class="day-date">10月12日 星期日</div>
                            <div class="day-location">札幌深度遊</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">🍫 白色戀人公園</div>
                                    <div class="summary-item">⛩️ 北海道神宮</div>
                                    <div class="summary-item">🌸 圓山公園</div>
                                    <div class="summary-item">🍖 達摩成吉思汗烤肉</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• 購買ドニチカキップ（週日券）¥520</div>
                                    <div>• 白色戀人公園門票 ¥800，停留 2.5-3h</div>
                                    <div>• 圓山→神宮需搭巴士 ¥210（或步行 15 分）</div>
                                    <div>• 達摩本店 17:00 營業，建議提前排隊</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d2-activity-1" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">札幌地鐵一日遊</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b style="color: #1976d2;">🚇 ドニチカキップ（週日券）：¥520</b><br>
                                今日 5 趟地鐵，原價 ¥1,170，省 ¥650！<br>
                                💡 圓山→神宮需搭巴士（¥210）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d2-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">07:30</span>
                                    <div class="activity-title">飯店自助早餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🍽️ 札幌格蘭大酒店早餐</span><br>
                                北海道食材豐富 | 悠閒用餐
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d2-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">10:00</span>
                                    <div class="activity-title">白色戀人公園</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚇 東西線→宮之澤站（25分）</span><br>
                                門票：¥800 | 停留：2.5-3h | 霜淇淋必吃<br>
                                💡 巧克力工廠、歐式庭園、DIY 餅乾
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d2-activity-4">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:00</span>
                                    <div class="activity-title">公園內午餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🍽️ 梟巢餐廳（推薦）</span><br>
                                湯咖哩：¥1,500-2,000 | 停留：1h
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d2-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">13:30</span>
                                    <div class="activity-title">北海道神宮</div>
                                    <span class="importance-badge importance-recommend">⭐⭐ 推薦</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚇 圓山公園站 + 🚌 巴士¥210（5分）</span><br>
                                或步行 15 分 | 參拜：二拜二拍手一拜<br>
                                💡 六花亭茶屋限定點心 ¥350
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d2-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:00</span>
                                    <div class="activity-title">回飯店休息</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚇 大通站</span><br>
                                休息 2-3h | 17:00 再出發
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d2-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">17:30</span>
                                    <div class="activity-title">晚餐：達摩本店（成吉思汗烤肉）</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚇 薄野站（2站）</span>
                                <span class="food-badge">🍖 生羊肉</span><br>
                                預算：¥3,000-4,000 | 17:00 營業，需排隊 30-60 分<br>
                                💡 詳細資訊請參考 <b>🍜 美食</b> 分頁
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d2-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d2-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">20:00</span>
                                    <div class="activity-title">薄野周邊散步</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                薄野十字路口夜景 | 唐吉訶德（24h）| 拉麵橫丁<br>
                                • 薄野站搭地鐵2站到札幌站<br>
                                • 車程5分鐘<br>
                                • 步行5分鐘回飯店<br>
                                <div style="background: #e1f5fe; padding: 8px; border-radius: 5px; margin-top: 8px;">
                                    <b>💡 彈性建議</b><br>
                                    看當天體力和興趣決定<br>
                                    • 有體力：逛唐吉訶德+拍夜景<br>
                                    • 想休息：直接回飯店<br>
                                    • 想吃宵夜：去拉麵橫丁<br>
                                    🚇 薄野站末班車約23:30，不用擔心
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Day 3 -->
            <div class="section" id="day3">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">3</div>
                        <div class="day-title">
                            <div class="day-date">10月13日 星期一</div>
                            <div class="day-location">小樽半日遊→洞爺湖</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">🏮 小樽運河</div>
                                    <div class="summary-item">🛍️ 堺町通商店街</div>
                                    <div class="summary-item">🥐 六花亭現烤餅</div>
                                    <div class="summary-item">🌊 洞爺湖溫泉</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• 08:00 退房，帶全部行李</div>
                                    <div>• ✅ JR Pass 今天開始使用（第 1 天）</div>
                                    <div>• 12:30 前務必回小樽站取行李</div>
                                    <div>• 13:42 特急北斗往洞爺（需預約指定席）</div>
                                    <div>• 洞爺站→溫泉巴士 ¥340（飯店無接駁車）</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d3-activity-1" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">札幌 → 小樽 → 洞爺湖</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b style="color: #1976d2;">✅ JR Pass 開始使用（第 1 天）</b><br>
                                🚃 札幌→小樽：JR 快速（40分）自由席<br>
                                🚃 小樽→洞爺：JR 特急北斗 13:42（1h46m）需劃位<br>
                                🚌 洞爺站→溫泉：巴士 ¥340（20分）<br>
                                💡 12:30 前務必回小樽站
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">08:00</span>
                                    <div class="activity-title">飯店退房</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                帶全部行李 | 確認 JR Pass 與指定席
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">08:30</span>
                                    <div class="activity-title">前往小樽</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚃 JR 函館本線快速（40分）自由席 | 札幌 4 號月台 | 右側看海景
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-4">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:10</span>
                                    <div class="activity-title">JR小樽站寄放行李</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                置物櫃：大 ¥700 / 中 ¥500 | 📸 拍照記錄櫃號
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:25</span>
                                    <div class="activity-title">前往南小樽（起點）</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚃 建議搭 JR 1 站到南小樽（2分）| 從南往北逛不走回頭路
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:35</span>
                                    <div class="activity-title">童話十字路口</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                堺町通起點 | 蒸氣鐘（每15分鐘噴氣）| 歐式建築拍照
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:50</span>
                                    <div class="activity-title">堺町通商店街</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                北一硝子 | 音樂盒堂 | LeTAO 本店 | 重點逛 LeTAO、北一硝子
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">10:30</span>
                                    <div class="activity-title">六花亭現烤餅</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🥐 六花亭堺町通店 | <b>現烤葡萄奶油餅</b>（免費）| 小樽限定，每人限2個
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-9">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-9')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:00</span>
                                    <div class="activity-title">北菓樓快速採購</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🍰 北菓樓堺町通店 | 泡芙 ¥300（現吃）| 年輪蛋糕伴手禮
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-10">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-10')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:15</span>
                                    <div class="activity-title">小樽運河拍照</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                📸 淺草橋拍攝倉庫群（步行5分）| 可選運河遊船 ¥1,500
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-11">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-11')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:30</span>
                                    <div class="activity-title">午餐：海鮮丼 or 壽司</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b>選項 1：</b>滝波食堂（三角市場）¥2,000-3,500 | 自選海鮮丼<br>
                                <b>選項 2：</b>政壽司本店 ¥3,800-6,000 | 板前壽司體驗<br>
                                ⚠️ 11:00 前抵達避開人潮 | 預留 1.5-2 小時（含排隊）<br>
                                💡 詳細資訊請參考 <b>🍜 美食</b> 分頁
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-12">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-12')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:20</span>
                                    <div class="activity-title">回小樽站取行李</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                從三角市場步行5分至小樽站 | 取行李準備搭車
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-13">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-13')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:30</span>
                                    <div class="activity-title">返回札幌</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚃 JR 快速回札幌（40分）| 班次：12:27 / 12:49
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-14">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-14')">
                                <div class="timeline-basic">
                                    <span class="time-badge">13:30</span>
                                    <div class="activity-title">前往洞爺湖</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚃 JR 特急北斗（1h40m）指定席 | 右側看羊蹄山
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-15">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-15')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:10</span>
                                    <div class="activity-title">抵達洞爺站→前往飯店</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚌 道南巴士 ¥340（20分）| 🚕 計程車 ¥2,000-3,000<br>
                                ⚠️ 無接駁車 | 4人分攤計程車較划算
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-16">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-16')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:00</span>
                                    <div class="activity-title">飯店入住</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                ♨️ ザ・レイクスイート 湖の栖 | 全客室私人露天溫泉 | 湖景
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-17">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-17')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:30</span>
                                    <div class="activity-title">溫泉街散步</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                湖畔散步道 | 免費足湯 | 雕刻公園 | 溫泉布丁 ¥350
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-18">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-18')">
                                <div class="timeline-basic">
                                    <span class="time-badge">18:00</span>
                                    <div class="activity-title">飯店晚餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                飯店內用餐（建議預訂）| 私人溫泉 | 準備觀賞煙火
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-19">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-19')">
                                <div class="timeline-basic">
                                    <span class="time-badge">20:45</span>
                                    <div class="activity-title">洞爺湖煙火秀</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🎆 4月底-10月底每晚 20:45（20分）| 飯店陽台或湖畔觀賞<br>
                                ⚠️ 10月下旬可能已結束 | 湖邊較涼記得帶外套
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d3-activity-20">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d3-activity-20')">
                                <div class="timeline-basic">
                                    <span class="time-badge">21:30</span>
                                    <div class="activity-title">享受溫泉</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                泡私人露天溫泉 | 夜晚湖景 | 早點休息
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Day 4 -->
            <div class="section" id="day4">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">4</div>
                        <div class="day-title">
                            <div class="day-date">10月14日 星期二</div>
                            <div class="day-location">洞爺湖悠閒一日</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">⛴️ 洞爺湖遊覽船</div>
                                    <div class="summary-item">🚡 有珠山纜車</div>
                                    <div class="summary-item">🌋 昭和新山</div>
                                    <div class="summary-item">♨️ 溫泉與煙火</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• JR Pass 今天休息，使用 ICOCA + 巴士</div>
                                    <div>• 道南巴士往返有珠山 ¥340（班次少！）</div>
                                    <div>• 有珠山纜車 ¥1,800（6 分鐘到山頂）</div>
                                    <div>• 洞爺湖煙火 20:45（4月底-10月底）</div>
                                    <div>• 建議請飯店協助查詢巴士時刻表</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d4-activity-1" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">Day 4 交通安排</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b style="color: #1976d2;">🚌 ICOCA + 巴士（JR Pass 第2天休息）</b><br>
                                🚌 道南巴士往返有珠山：¥340 單程（15分）| 班次少，注意時刻表<br>
                                🚡 有珠山纜車：¥1,800（6分直達山頂）| 無障礙設計<br>
                                💡 可請飯店協助查詢時刻或叫計程車（約¥2,000）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">08:00</span>
                                    <div class="activity-title">飯店早餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                飯店早餐 | 面湖餐廳欣賞晨景 | 悠閒用餐
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:00</span>
                                    <div class="activity-title">晨間溫泉</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                私人露天溫泉 | 欣賞洞爺湖晨景 | 寧靜湖畔時光
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-4">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge">10:30</span>
                                    <div class="activity-title">洞爺湖遊覽船</div>
                                    <span class="importance-badge importance-recommend">⭐⭐ 推薦</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚢 城堡造型觀光船 ¥1,500（50分）| 可登中島散步<br>
                                每30分一班 | 二樓甲板風景最佳 | 可餵海鷗
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:00</span>
                                    <div class="activity-title">午餐：湖畔料理</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🍱 望羊蹄餐廳（萬世閣內）| 烤扇貝定食 ¥1,800 | 無需預約
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">13:30</span>
                                    <div class="activity-title">有珠山纜車</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚌 巴士15分 | 🚡 纜車 ¥1,800（6分直達）| 360度火山全景<br>
                                無障礙設計 | 活火山噴氣孔 | 洞爺湖絕佳視角 | 約1.5小時
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">14:30</span>
                                    <div class="activity-title">昭和新山&熊牧場（可選）</div>
                                    <span class="importance-badge importance-recommend">⭐⭐ 推薦</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                火山遺跡免費參觀 | 熊牧場 ¥850（可選）| 拍照、霜淇淋
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:30</span>
                                    <div class="activity-title">返回飯店</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🚌 巴士回溫泉街 | 回飯店休息 | 準備溫泉時光
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-9">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-9')">
                                <div class="timeline-basic">
                                    <span class="time-badge">16:00</span>
                                    <div class="activity-title">下午溫泉時光</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                私人露天溫泉 | 洞爺湖午後美景 | 完全放鬆
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-10">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-10')">
                                <div class="timeline-basic">
                                    <span class="time-badge">18:00</span>
                                    <div class="activity-title">飯店晚餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                飯店內用餐 | 會席料理或自助餐 | 當地食材
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-11">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-11')">
                                <div class="timeline-basic">
                                    <span class="time-badge">20:00</span>
                                    <div class="activity-title">湖畔散步</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                溫泉街夜晚漫步 | 免費足湯 | 溫泉布丁 ¥350 | 準備觀賞煙火
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-12">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-12')">
                                <div class="timeline-basic">
                                    <span class="time-badge">20:45</span>
                                    <div class="activity-title">洞爺湖煙火秀</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                🎆 4月底-10月底每晚 20:45（20分）| 飯店陽台或湖畔觀賞<br>
                                ⚠️ 10月下旬可能已結束 | 湖邊較涼記得帶外套
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d4-activity-13">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d4-activity-13')">
                                <div class="timeline-basic">
                                    <span class="time-badge">21:30</span>
                                    <div class="activity-title">夜間溫泉</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                夜間溫泉 | 洞爺湖夜景 | 早點休息
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Day 5 -->
            <div class="section" id="day5">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">5</div>
                        <div class="day-title">
                            <div class="day-date">10月15日 星期三</div>
                            <div class="day-location">洞爺湖→函館</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">🚃 特急北斗號</div>
                                    <div class="summary-item">🌸 五稜郭公園</div>
                                    <div class="summary-item">🏔️ 函館山夜景</div>
                                    <div class="summary-item">🏭 金森紅磚倉庫</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• 11:00 前退房，帶全部行李</div>
                                    <div>• 洞爺湖溫泉→洞爺站 巴士 ¥340（建議搭計程車 ¥2,500）</div>
                                    <div>• 特急北斗16號 12:12 發車（需預約指定席）</div>
                                    <div>• 函館市電一日券 ¥600（今明各買1張）</div>
                                    <div>• 函館山纜車 ¥1,500，16:30 日落前上山</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d5-activity-1" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">Day 5 交通安排</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b style="color: #1976d2;">✅ 使用 JR Pass 5日券（第3天）</b><br><br>

                                <b>📍 今日路線：</b>洞爺湖→函館<br><br>

                                <b>🚌 洞爺湖溫泉→洞爺站：</b>道南巴士 ¥340（20分鐘） | 計程車 ¥2,000-3,000（推薦）<br>
                                <b>🚃 洞爺→函館：</b>JR 特急北斗16號（12:12發），2h4m，JR Pass 免費<br>
                                <b>🚋 函館站→飯店：</b>市電一日券 ¥600（今明兩天各買1張）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">08:00</span>
                                    <div class="activity-title">飯店早餐 & 晨間溫泉</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                面湖餐廳早餐 | 最後一次泡私人露天溫泉 | 欣賞洞爺湖晨景
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">10:30</span>
                                    <div class="activity-title">飯店退房→前往JR洞爺站</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">♨️ ザ・レイクスイート 湖の栖</span><br>
                                Check-out: 11:00 | <span class="transport-badge">🚌 道南巴士 ¥340</span> 或 <span class="transport-badge">🚕 計程車 ¥2,000-3,000（推薦）</span>
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-4">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:30</span>
                                    <div class="activity-title">車站簡餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                JR洞爺站內便當或附近餐廳 | 預算：¥1,000/人
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:12</span>
                                    <div class="activity-title">前往函館</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚃 JR特急北斗16號</span><br>
                                2h4m | 指定席已在 Day 1 劃好 | 14:16 抵達函館站
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">14:30</span>
                                    <div class="activity-title">抵達函館→飯店Check-in</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🏨 fav HAKODATE</span><br>
                                購買市電一日券 ¥600 | 領取函館朝市餐券（明日早餐用）<br>
                                ⏰ Check-in: 15:00 / Check-out: 10:00（比其他飯店早1小時）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:30</span>
                                    <div class="activity-title">金森紅磚倉庫</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚋 市電→十字街站</span><br>
                                明治倉庫群 | 音樂盒、玻璃製品 | 函館啤酒館、Petite Merveille 起司蛋糕
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">17:00</span>
                                    <div class="activity-title">函館山纜車</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚡 纜車來回 ¥1,800</span><br>
                                從紅磚倉庫步行15分 | 17:00前上山卡位 | ⚠️ 山頂溫度低10度，帶外套
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-9">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-9')">
                                <div class="timeline-basic">
                                    <span class="time-badge">18:30</span>
                                    <div class="activity-title">百萬夜景</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                世界三大夜景 | 最佳拍攝點：展望台2樓 | 避開團客往停車場方向
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-10">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-10')">
                                <div class="timeline-basic">
                                    <span class="time-badge">19:30</span>
                                    <div class="activity-title">晚餐：函館名物</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🍜 あじさい（鹽味拉麵）¥1,200</span> 或 <span class="food-badge">🍔 幸運小丑漢堡 ¥1,000</span><br>
                                💡 建議選拉麵（明日午餐會吃幸運小丑）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d5-activity-11">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d5-activity-11')">
                                <div class="timeline-basic">
                                    <span class="time-badge">21:00</span>
                                    <div class="activity-title">返回飯店休息</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                整理行李、準備明日朝市
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Day 6 -->
            <div class="section" id="day6">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">6</div>
                        <div class="day-title">
                            <div class="day-date">10月16日 星期四</div>
                            <div class="day-location">函館文化美食之旅</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">🐟 函館朝市</div>
                                    <div class="summary-item">⛪ 八幡坂</div>
                                    <div class="summary-item">🏛️ 元町教堂群</div>
                                    <div class="summary-item">🍜 大門橫丁</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• 函館朝市 06:00 開始營業</div>
                                    <div>• 10:00 前退房，行李寄放飯店</div>
                                    <div>• 市電一日券 ¥600（五稜郭→元町）</div>
                                    <div>• 元町教堂區大多免費參觀</div>
                                    <div>• 大門橫丁晚餐（鹽拉麵推薦）</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d6-activity-1" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">Day 6 交通安排</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b style="color: #1976d2;">🚌 五稜郭・トラピスチヌシャトルバス（5系統）+ 市電一日券</b><br><br>

                                <b>📍 今日路線：</b>朝市→トラピスチヌ→五稜郭→駅前→元町/灣區<br><br>

                                <b>🚌 5系統巴士：</b>函館駅前→トラピスチヌ ¥500 | トラピスチヌ→五稜郭 ¥400<br>
                                <b>🚋 市電一日券：</b>¥600（五稜郭→駅前→元町/灣區）<br>
                                <b>💰 今日交通總計：</b>約 ¥1,500/人
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">07:00</span>
                                    <div class="activity-title">函館朝市早餐</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🍣 函館朝市（用飯店餐券）</span><br>
                                <span class="transport-badge">🚶 飯店步行3分鐘</span><br>
                                海鮮丼、活烏賊丼 | 釣烏賊體驗 ¥500 | ⚠️ 早起因 10:00 退房
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">08:30</span>
                                    <div class="activity-title">回飯店退房</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🏨 fav HAKODATE</span><br>
                                Check-out: 10:00 | 行李寄放飯店
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-4">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:00</span>
                                    <div class="activity-title">前往トラピスチヌ修道院</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚌 5系統シャトルバス ¥500</span><br>
                                函館駅前4號乘車處→トラピスチヌ前（37分鐘）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:45</span>
                                    <div class="activity-title">トラピスチヌ修道院</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">⛪ 天使聖母トラピスチヌ修道院</span><br>
                                日本第一座女子修道院（1898年）| 門票：免費 | 參觀：30-45分鐘<br>
                                法國哥德式紅磚建築 | 必買：修道院奶油糖 ¥500、手工餅乾 ¥800
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:00</span>
                                    <div class="activity-title">前往五稜郭</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚌 5系統シャトルバス ¥400</span><br>
                                トラピスチヌ前→五稜郭タワー前（24分鐘）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:30</span>
                                    <div class="activity-title">五稜郭塔</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">⭐ 五稜郭タワー</span><br>
                                門票：¥1,000 | 參觀：30-40分鐘<br>
                                俯瞰完整星形要塞 | 360度函館市景、函館山 | 展望台咖啡廳
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:30</span>
                                    <div class="activity-title">午餐：幸運小丑漢堡</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🍔 ラッキーピエロ 五稜郭公園前店</span><br>
                                預算：¥1,200-1,500/人 | 推薦：中華炸雞漢堡<br>
                                步行3分鐘 | 午餐時段排隊 10-20 分鐘
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-9">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-9')">
                                <div class="timeline-basic">
                                    <span class="time-badge">14:00</span>
                                    <div class="activity-title">返回函館駅前</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚋 市電一日券</span><br>
                                五稜郭公園前→函館駅前（15分鐘）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-10">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-10')">
                                <div class="timeline-basic">
                                    <span class="time-badge">14:30</span>
                                    <div class="activity-title">飯店休息</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                回 fav HAKODATE 休息 | 下午休息時間 | 今晚續住同一飯店
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-11">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-11')">
                                <div class="timeline-basic">
                                    <span class="time-badge">16:00</span>
                                    <div class="activity-title">函館站周邊</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚶 飯店步行即可</span><br>
                                函館駅前百貨（棒二森屋）| 或繼續飯店休息
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-12">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-12')">
                                <div class="timeline-basic">
                                    <span class="time-badge">18:00</span>
                                    <div class="activity-title">晚餐：海鮮居酒屋</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🦀 函館海鮮居酒屋 海光房</span><br>
                                預算：¥4,000-5,000/人 | 📞 0138-24-1010<br>
                                活烏賊造身、帆立貝、毛蟹 | 💡 詳見美食分頁
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d6-activity-13">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d6-activity-13')">
                                <div class="timeline-basic">
                                    <span class="time-badge">20:00</span>
                                    <div class="activity-title">返回飯店</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                整理行李準備明早退房 | ⏰ 明早 10:00 前退房，09:15 搭 JR 回札幌<br>
                                確認 JR Pass 還有 1 天效期（Day 7 最後一天）
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Day 7 -->
            <div class="section" id="day7">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">7</div>
                        <div class="day-title">
                            <div class="day-date">10月17日 星期五</div>
                            <div class="day-location">返回札幌</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">🚃 特急北斗返札幌</div>
                                    <div class="summary-item">🍫 白色戀人公園</div>
                                    <div class="summary-item">🛍️ 狸小路採購</div>
                                    <div class="summary-item">🦀 海鮮市場</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• 07:30 早餐 & 08:30 前退房</div>
                                    <div>• 特急北斗6號 09:18 發車（需預約指定席）</div>
                                    <div>• ⚠️ 在新札幌站下車（札幌站前一站）</div>
                                    <div>• ✅ JR Pass 今天是最後使用日（第 5 天）</div>
                                    <div>• 白色戀人公園門票 ¥800（如要再訪）</div>
                                    <div>• 最後採購機會：狸小路、二條市場</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d7-activity-1" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">Day 7 交通安排</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b style="color: #1976d2;">✅ 使用 JR Pass 5日券（第5天，最後1天）</b><br><br>

                                <b>📍 今日路線：</b>函館→新札幌（直達）<br><br>

                                <b>🚃 函館→新札幌：</b>JR 特急北斗6號（09:18發），3h30m，JR Pass 免費<br>
                                <b>⚠️ 重要：</b>在新札幌站下車（札幌站前一站），步行3分鐘到飯店<br>
                                <b>💡 優勢：</b>不用轉車、省 ¥260、提早 10-15 分鐘到飯店
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">07:30</span>
                                    <div class="activity-title">飯店早餐 & 退房</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                快速用餐 | fav HAKODATE check-out | 拖行李到函館站（10分鐘）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:18</span>
                                    <div class="activity-title">搭車回新札幌</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚃 特急北斗6號</span><br>
                                函館→新札幌（直達），3h30m | 建議買站內便當上車吃<br>
                                ⚠️ 在新札幌站下車（札幌站前一站）| JR Pass 最後使用日
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-4">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:50</span>
                                    <div class="activity-title">抵達新札幌→飯店Check-in</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🏨 ホテルエミシア札幌</span><br>
                                📞 011-895-8811 | 31層飯店<br>
                                步行3分鐘 | 31樓景觀餐廳 | 大浴場溫泉 | 車站直結商場 | 明早去機場28分鐘
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">13:40</span>
                                    <div class="activity-title">午餐：新札幌美食</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🍚 小松水產（海鮮丼）¥990</span> | <span class="food-badge">🍗 三ツ星ザンギ ¥1,000</span> | <span class="food-badge">🍔 Chicken Pecker ¥960</span><br>
                                📍 サンピアザ地下 或 Duo-1 內 | 車站商圈，無需預約
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:00</span>
                                    <div class="activity-title">新札幌購物時光</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚶 車站直結</span><br>
                                サンピアザ：130間店、AEON超市、藥妝店、北海道特產<br>
                                Duo-1/2：UNIQLO、GU、無印良品
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">16:30</span>
                                    <div class="activity-title">サンピアザ水族館（選擇性）</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🐟 新さっぽろサンピアザ水族館</span><br>
                                門票：¥1,000 | 10:00-18:30 | 約200種生物 | 參觀1小時<br>
                                💡 或繼續購物、回飯店泡溫泉
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">17:30</span>
                                    <div class="activity-title">飯店休息</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                回房放戰利品 | 泡大浴場溫泉（6F）| 健身房、游泳池、Lobby咖啡廳
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-9">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-9')">
                                <div class="timeline-basic">
                                    <span class="time-badge">19:00</span>
                                    <div class="activity-title">最後晚餐</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🌃 飯店31樓景觀餐廳 ¥3,000-5,000</span>（推薦，可看夜景）<br>
                                <span class="food-badge">🍺 宴や 紀らく ¥3,000-4,000</span> | <span class="food-badge">🍽️ 商場內餐廳 ¥1,500-2,500</span><br>
                                💡 推薦飯店餐廳，用餐後直接回房
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d7-activity-10">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d7-activity-10')">
                                <div class="timeline-basic">
                                    <span class="time-badge">21:00</span>
                                    <div class="activity-title">最後採購＆休息</div>
                                    <span class="importance-badge importance-recommend">⭐⭐ 推薦</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                AEON超市買零食 | 藥妝店最後補貨 | 便利商店買明天早餐<br>
                                整理行李 | 確認ICOCA餘額 | 檢查護照、機票<br>
                                ⚠️ 明早 07:00 退房，07:30 搭 JR 快速 Airport（28分鐘，約 ¥800-900）
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Day 8 -->
            <div class="section" id="day8">
                <div class="day-card">
                    <div class="day-header">
                        <div class="day-number">8</div>
                        <div class="day-title">
                            <div class="day-date">10月18日 星期六</div>
                            <div class="day-location">✈️ 返回台灣</div>
                        </div>
                    </div>

                    <div class="day-summary">
                        <div class="summary-header" onclick="toggleSummary(this)">
                            <div class="summary-title">
                                <span>✨</span>
                                <span>今日重點</span>
                            </div>
                            <div class="summary-toggle">▼</div>
                        </div>
                        <div class="summary-content">
                            <div class="summary-section">
                                <div class="summary-label">📍 核心亮點</div>
                                <div class="summary-items">
                                    <div class="summary-item">🛍️ 最後採購</div>
                                    <div class="summary-item">✈️ 新千歲機場</div>
                                    <div class="summary-item">🎁 機場伴手禮</div>
                                    <div class="summary-item">🏠 返回台灣</div>
                                </div>
                            </div>
                            <div class="summary-section">
                                <div class="summary-label">⚠️ 關鍵提醒</div>
                                <div class="summary-alerts">
                                    <div>• 06:30 起床，07:00 退房</div>
                                    <div>• 新札幌→機場 JR 快速 Airport 07:30（28 分鐘）</div>
                                    <div>• 使用 ICOCA 卡 ¥800-900（JR Pass 已用完）</div>
                                    <div>• ⚠️ 預留 2 小時辦理登機、退稅、託運</div>
                                    <div>• 航班：IT235，13:30 起飛（提前 2 小時到）</div>
                                    <div>• 確認護照、機票、檢查行李重量</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="timeline">
                        <div class="timeline-item" data-item-id="d8-activity-1" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-1')">
                                <div class="timeline-basic">
                                    <span class="time-badge" style="background: #2196f3;">🎫</span>
                                    <div class="activity-title">Day 8 交通安排</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <b style="color: #1976d2;">💳 使用 ICOCA 卡</b><br><br>

                                <b>📍 今日路線：</b>新札幌→新千歲機場<br><br>

                                <b>🚃 新札幌→機場：</b>JR 快速 Airport（07:30發），28分鐘，約 ¥800-900（ICOCA）<br>
                                ⚠️ 注意方向：新千歲機場（不是小樽）| 每15分鐘一班
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-2">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-2')">
                                <div class="timeline-basic">
                                    <span class="time-badge">06:30</span>
                                    <div class="activity-title">起床整理 & 退房</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                檢查行李 | 護照、機票確認 | 確認ICOCA餘額 | 07:00 飯店退房
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-3">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-3')">
                                <div class="timeline-basic">
                                    <span class="time-badge">07:30</span>
                                    <div class="activity-title">前往機場</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="transport-badge">🚃 JR快速Airport（用ICOCA）</span><br>
                                新札幌站→新千歲機場，28分鐘 | 比札幌站快10分鐘、便宜 ¥300
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-4">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-4')">
                                <div class="timeline-basic">
                                    <span class="time-badge">08:30</span>
                                    <div class="activity-title">抵達機場</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                國際線4樓 | 退稅櫃檯（如需要）
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-5">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-5')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:00</span>
                                    <div class="activity-title">辦理登機</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                虎航櫃檯 check-in | 託運行李（20kg/人）| 拿登機證
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-6">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-6')">
                                <div class="timeline-basic">
                                    <span class="time-badge">09:30</span>
                                    <div class="activity-title">最後血拼</div>
                                    <span class="importance-badge importance-must">⭐⭐⭐ 必訪</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                <span class="food-badge">🎁 必買伴手禮</span><br>
                                白色戀人 | 六花亭葡萄餅 | Royce生巧克力（需冷藏）| 薯條三兄弟 | LeTAO起司蛋糕<br>
                                拉麵道場（國內線3F）| 北海道牛奶霜淇淋 | 機場便當
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-7">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-7')">
                                <div class="timeline-basic">
                                    <span class="time-badge">10:30</span>
                                    <div class="activity-title">通關出境</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                安檢（液體100ml內）| 出境審查 | 前往登機門
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-8">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-8')">
                                <div class="timeline-basic">
                                    <span class="time-badge">11:00</span>
                                    <div class="activity-title">免稅店</div>
                                    <span class="importance-badge importance-recommend">⭐⭐ 推薦</span>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                限定KitKat | 美瑛選果果醬 | 北海道牛奶餅乾 | 免稅價比市區便宜 5-10%
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-9">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-9')">
                                <div class="timeline-basic">
                                    <span class="time-badge">12:05</span>
                                    <div class="activity-title">起飛返台</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                航班：IT235 | 飛行時間：4小時45分
                            </div>
                        </div>

                        <div class="timeline-item" data-item-id="d8-activity-10">
                            <div class="timeline-header" onclick="toggleTimelineDetail('d8-activity-10')">
                                <div class="timeline-basic">
                                    <span class="time-badge">15:50</span>
                                    <div class="activity-title">抵達桃園機場</div>
                                </div>
                                <button class="timeline-expand-btn" onclick="event.stopPropagation()">
                                    <span>詳情</span>
                                    <span class="icon">▼</span>
                                </button>
                            </div>
                            <div class="timeline-detail">
                                入境審查 | 領取行李 | 通關入境 | 🏠 平安到家！
                            </div>
                        </div>
                    </div>
                    
                    <div class="tip-box">
                        <div class="tip-title">✈️ 機場提醒</div>
                        <div>• Royce巧克力要託運（含酒精）</div>
                        <div>• 起司蛋糕需保冷袋</div>
                        <div>• 留¥1,000搭機場JR</div>
                        <div>• 提早2小時到機場</div>
                    </div>
                </div>
            </div>
            
            <!-- 美食總覽 -->
            <div class="section" id="restaurants">
                <h2>🍽️ 美食推薦總整理</h2>

                <!-- 搜尋與過濾系統 -->
                <div class="search-container">
                    <div class="search-box">
                        <input
                            type="text"
                            id="searchInput"
                            class="search-input"
                            placeholder="搜尋餐廳名稱、類型或特色..."
                            oninput="performSearch()"
                        >
                        <span class="search-icon" id="searchIcon">🔍</span>
                        <button class="clear-search" id="clearSearch" onclick="clearSearch()">×</button>
                    </div>

                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all" onclick="filterItems('all')">
                            全部
                        </button>
                        <button class="filter-btn" data-filter="拉麵" onclick="filterItems('拉麵')">
                            🍜 拉麵
                        </button>
                        <button class="filter-btn" data-filter="壽司" onclick="filterItems('壽司')">
                            🍣 壽司
                        </button>
                        <button class="filter-btn" data-filter="螃蟹" onclick="filterItems('螃蟹')">
                            🦀 螃蟹
                        </button>
                        <button class="filter-btn" data-filter="海鮮" onclick="filterItems('海鮮')">
                            🍱 海鮮
                        </button>
                        <button class="filter-btn" data-filter="速食" onclick="filterItems('速食')">
                            🍔 速食
                        </button>
                    </div>

                    <div class="search-results-info" id="searchResultsInfo"></div>
                </div>

                <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px;">⚠️ 需要預約的餐廳（按優先順序）</div>
                    <div style="font-size: 14px;">
                        1. <b>かに將軍</b> - 螃蟹料理（Day1晚餐）📞 050-5890-8938<br>
                        2. <b>政壽司</b> - 小樽壽司（Day3午餐選擇）📞 0134-22-0011<br>
                        3. <b>海鮮處花月</b> - 毛蟹料理（Day6午餐）📞 0138-57-1112<br>
                        <hr style="margin: 10px 0;">
                        💡 <b>預約方式：</b>請飯店櫃檯協助最方便！
                    </div>
                </div>
                
                <div style="background: #d4edda; border: 2px solid #28a745; border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="font-weight: bold; margin-bottom: 10px;">✅ 無需預約的美食（隨時可去）</div>
                    <div style="font-size: 14px;">
                        <b>札幌：</b><br>
                        • 拉麵橫丁（17間拉麵店）- 營業到凌晨3點<br>
                        • 二条市場海鮮丼 - 早上7點開始營業<br>
                        • ESTA拉麵共和國 - 8間名店聚集<br>
                        • 狸小路一蘭拉麵 - 24小時營業<br><br>
                        
                        <b>小樽：</b><br>
                        • 三角市場海鮮 - 多間店家可選<br>
                        • 堺町通甜點街 - LeTAO、北菓樓、六花亭<br><br>
                        
                        <b>函館：</b><br>
                        • 函館朝市 - 500間店舖，5:00開始<br>
                        • 大門橫丁 - 26間居酒屋<br>
                        • 幸運小丑漢堡 - 17間分店
                    </div>
                </div>
                
                <div class="restaurant-card" data-item-id="restaurant-ramen-yokocho">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-ramen-yokocho')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍜 拉麵橫丁</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">拉麵</span>
                                <span class="price-range">¥¥</span>
                                <span class="restaurant-tag no-booking">✅ 無需預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 薄野5-6丁目<br>
                        ⏰ 11:00-03:00<br>
                        💡 17間拉麵店，推薦：白樺山莊、げんこつ屋<br>
                        ✅ <b>無需預約</b>，現場排隊<br>
                        🎯 備案：拉麵共和國（ESTA 10F）
                    </div>
                </div>

                <div class="restaurant-card" data-item-id="restaurant-kani-shogun">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-kani-shogun')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🦀 かに將軍</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">螃蟹料理</span>
                                <span class="price-range">¥¥¥¥</span>
                                <span class="restaurant-tag booking-required">⚠️ 必須預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 薄野4-2-6<br>
                        ⏰ 11:30-22:00<br>
                        📞 050-5890-8938<br>
                        💡 螃蟹會席料理，需預約<br>
                        ⚠️ <b>必須預約</b>，建議2週前<br>
                        🎯 備案：蟹本家（薄野店）
                    </div>
                </div>
                
                <div class="restaurant-card" data-item-id="restaurant-donburi-chaya">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-donburi-chaya')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍱 海鮮處どんぶり茶屋</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">海鮮丼</span>
                                <span class="price-range">¥¥¥</span>
                                <span class="restaurant-tag no-booking">✅ 無需預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 札幌二条市場內<br>
                        ⏰ 07:00-17:00<br>
                        💡 超新鮮海鮮，推薦特上海鮮丼<br>
                        ✅ <b>無需預約</b>，建議早點到<br>
                        🎯 備案：場外市場（7:00開始）
                    </div>
                </div>

                <div class="restaurant-card" data-item-id="restaurant-daruma">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-daruma')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍖 成吉思汗達摩</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">烤羊肉</span>
                                <span class="price-range">¥¥¥</span>
                                <span class="restaurant-tag no-booking">✅ 無需預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 薄野有多間分店<br>
                        ⏰ 17:00-03:00<br>
                        💡 6.4店最有名，需排隊<br>
                        ✅ <b>無需預約</b>，17:30前到較快<br>
                        🎯 備案：4.4店、5.5店人較少
                    </div>
                </div>

                <div class="restaurant-card" data-item-id="restaurant-nemuro-hanamaru">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-nemuro-hanamaru')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍣 根室花丸</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">迴轉壽司</span>
                                <span class="price-range">¥¥¥</span>
                                <span class="restaurant-tag no-booking">✅ 無需預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 KITTE札幌6F<br>
                        ⏰ 11:00-22:00<br>
                        💡 CP值高，推薦當日限定<br>
                        ✅ <b>無需預約</b>，用餐時段需等位<br>
                        🎯 備案：ESTA美食街（多選擇）
                    </div>
                </div>

                <div class="restaurant-card" data-item-id="restaurant-masa-sushi">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-masa-sushi')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍣 政壽司</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">壽司</span>
                                <span class="price-range">¥¥¥¥</span>
                                <span class="restaurant-tag booking-required">📝 建議預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 小樽花園1-1<br>
                        ⏰ 11:00-21:00（週三休）<br>
                        💡 小樽第一壽司店<br>
                        ⚠️ <b>建議預約</b> 📞 0134-22-0011<br>
                        🌐 可用Tabelog線上預約<br>
                        🎯 備案：滝波食堂（三角市場）
                    </div>
                </div>

                <div class="restaurant-card" data-item-id="restaurant-lucky-pierrot">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-lucky-pierrot')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍔 幸運小丑漢堡</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">速食</span>
                                <span class="price-range">¥</span>
                                <span class="restaurant-tag no-booking">✅ 無需預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 函館限定（17間分店）<br>
                        ⏰ 10:00-00:00<br>
                        💡 中華炸雞漢堡必點<br>
                        ✅ <b>無需預約</b>，熱門店需排隊<br>
                        🎯 備案：五稜郭店、美原店人少
                    </div>
                </div>
                
                <div class="restaurant-card" data-item-id="restaurant-kantaro">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-kantaro')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍣 函太郎</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">迴轉壽司</span>
                                <span class="price-range">¥¥¥</span>
                                <span class="restaurant-tag no-booking">✅ 無需預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 函館宇賀浦町<br>
                        ⏰ 11:00-21:00<br>
                        💡 函館人氣第一迴轉壽司<br>
                        ✅ <b>無需預約</b>，現場取號等候<br>
                        🎯 17:30前人較少<br>
                        🎯 備案：函館朝市壽司店
                    </div>
                </div>

                <div class="restaurant-card" data-item-id="restaurant-hakodate-ramen">
                    <div class="restaurant-card-header" onclick="toggleRestaurantDetail('restaurant-hakodate-ramen')">
                        <div class="restaurant-basic-info">
                            <div class="restaurant-name">🍜 函館鹽拉麵</div>
                            <div class="restaurant-summary">
                                <span class="restaurant-type">拉麵</span>
                                <span class="price-range">¥¥</span>
                                <span class="restaurant-tag no-booking">✅ 無需預約</span>
                            </div>
                        </div>
                        <button class="restaurant-expand-btn" onclick="event.stopPropagation()">
                            <span>查看詳情</span>
                            <span class="icon">▼</span>
                        </button>
                    </div>
                    <div class="restaurant-detail">
                        📍 函館麵廚房あじさい（五稜郭）<br>
                        ⏰ 11:00-20:00<br>
                        💡 函館代表美食<br>
                        ✅ <b>無需預約</b>，避開用餐時間<br>
                        🎯 備案：函館拉麵alley
                    </div>
                </div>
                
                <div class="tip-box" style="margin-top: 20px;">
                    <div class="tip-title">🍴 用餐小貼士</div>
                    <div style="font-size: 13px;">
                        • <b>尖峰時段：</b>12:00-13:00、18:00-20:00<br>
                        • <b>省錢技巧：</b>午餐套餐比晚餐便宜30-50%<br>
                        • <b>排隊APP：</b>EPARK可遠端取號<br>
                        • <b>信用卡：</b>高級餐廳可刷卡，小店多收現金<br>
                        • <b>服務費：</b>日本無小費文化<br>
                        • <b>禁菸：</b>2020年後室內全面禁菸<br>
                        • <b>兒童餐：</b>多數餐廳有兒童餐具和座椅
                    </div>
                </div>
                
                <div class="tip-box" style="margin-top: 20px;">
                    <div class="tip-title">🥡 便利商店美食推薦</div>
                    <div style="font-size: 13px;">
                        <b>早餐選擇：</b><br>
                        • 飯糰（¥150）- 鮭魚、明太子口味<br>
                        • 三明治（¥300）- 蛋沙拉最受歡迎<br>
                        • 咖啡（¥100）- 7-11咖啡品質不錯<br><br>
                        
                        <b>宵夜選擇：</b><br>
                        • 關東煮（¥100-200/串）<br>
                        • 炸雞（¥200）- LAWSON炸雞最好吃<br>
                        • 泡麵（¥200-400）- 限定口味多<br><br>
                        
                        <b>甜點：</b><br>
                        • 布丁（¥150）- 各家都有特色<br>
                        • 泡芙（¥150）- 7-11泡芙超人氣<br>
                        • 霜淇淋（¥250）- 北海道牛奶口味
                    </div>
                </div>
            </div>
            
            <!-- 緊急聯絡 -->
            <div class="section" id="emergency">
                <h2>🆘 緊急聯絡資訊</h2>
                
                <div class="emergency-box">
                    <div class="emergency-title">📞 緊急電話</div>
                    <div class="contact-item">警察：110</div>
                    <div class="contact-item">火警/救護車：119</div>
                    <div class="contact-item">台北駐日經濟文化代表處：03-3280-7811</div>
                    <div class="contact-item">24小時中文服務：050-5539-1955</div>
                </div>
                
                <div class="emergency-box">
                    <div class="emergency-title">🏨 飯店聯絡</div>
                    <div class="contact-item">
                        <b>Day 1-2：札幌格蘭大酒店</b><br>
                        📞 011-261-3311<br>
                        📍 札幌市中央區北1西4<br>
                        💡 可協助餐廳預約
                    </div>
                    <div class="contact-item">
                        <b>Day 3-4：ザ・レイクスイート 湖の栖</b><br>
                        📞 0142-82-4121<br>
                        📍 北海道有珠郡壮瞥町字洞爺湖温泉7-1<br>
                        💡 高級溫泉旅館，全客室附私人露天溫泉
                    </div>
                    <div class="contact-item">
                        <b>Day 5-7：函館住宿建議</b><br>
                        fav HAKODATE<br>
                        📞 0138-86-5020<br>
                        📍 函館市若松町17-11<br>
                        或函館JR Inn<br>
                        📞 0138-26-7111<br>
                        📍 函館站步行3分鐘
                    </div>
                </div>
                
                <div class="emergency-box">
                    <div class="emergency-title">✈️ 航空公司</div>
                    <div class="contact-item">台灣虎航：+886-2-5599-2555</div>
                    <div class="contact-item">日本客服：+81-3-6455-0242</div>
                    <div class="contact-item">新千歲機場：0123-23-0111</div>
                </div>
                
                <div class="emergency-box">
                    <div class="emergency-title">🏥 醫療協助</div>
                    <div class="contact-item">
                        <b>札幌醫大附屬醫院</b><br>
                        📞 011-611-2111<br>
                        📍 有中文翻譯服務
                    </div>
                    <div class="contact-item">
                        <b>函館中央醫院</b><br>
                        📞 0138-52-1231<br>
                        📍 24小時急診
                    </div>
                    <div class="contact-item">觀光熱線（多語言）：050-3816-2787</div>
                    <div class="contact-item">日本醫療諮詢：#7119</div>
                </div>
                
                <div class="emergency-box">
                    <div class="emergency-title">💳 信用卡掛失</div>
                    <div class="contact-item">VISA：00531-44-0022</div>
                    <div class="contact-item">MasterCard：00531-11-3886</div>
                    <div class="contact-item">JCB：00-800-00090009</div>
                    <div class="contact-item">美國運通：0120-020-120</div>
                </div>
                
                <div class="emergency-box">
                    <div class="emergency-title">📱 實用APP</div>
                    <div class="contact-item">
                        <b>Safety tips</b><br>
                        日本官方防災APP（地震警報）
                    </div>
                    <div class="contact-item">
                        <b>Japan Hospital Guide</b><br>
                        醫院搜尋（支援中文）
                    </div>
                    <div class="contact-item">
                        <b>VoiceTra</b><br>
                        即時語音翻譯
                    </div>
                </div>
                
                <div class="tip-box">
                    <div class="tip-title">💊 常用日文</div>
                    <div>• 幫助：たすけて（tasukete）</div>
                    <div>• 醫生：いしゃ（isha）</div>
                    <div>• 藥局：やっきょく（yakkyoku）</div>
                    <div>• 疼痛：いたい（itai）</div>
                    <div>• 發燒：ねつ（netsu）</div>
                    <div>• 過敏：アレルギー（arerugii）</div>
                    <div>• 感冒藥：かぜぐすり（kaze-gusuri）</div>
                    <div>• 止痛藥：いたみどめ（itami-dome）</div>
                    <div>• 拉肚子：げり（geri）</div>
                    <div>• 頭痛：ずつう（zutsuu）</div>
                </div>
                
                <div class="tip-box">
                    <div class="tip-title">🏪 24小時營業地點</div>
                    <div style="font-size: 13px;">
                        <b>札幌：</b><br>
                        • 唐吉訶德（狸小路）<br>
                        • 7-11、LAWSON、FamilyMart<br>
                        • 一蘭拉麵（薄野）<br>
                        • すき家、吉野家（多分店）<br><br>
                        
                        <b>函館：</b><br>
                        • MEGA唐吉訶德（美原）<br>
                        • 便利商店（車站周邊多）<br>
                        • Hasegawa Store（部分店）
                    </div>
                </div>
                
                <div class="tip-box">
                    <div class="tip-title">💰 緊急現金</div>
                    <div style="font-size: 13px;">
                        <b>7-11 ATM：</b><br>
                        • 接受國外卡片<br>
                        • 24小時可用<br>
                        • 手續費約¥200-300<br><br>
                        
                        <b>郵局ATM：</b><br>
                        • 支援國際提款<br>
                        • 營業到18:00<br>
                        • 手續費較便宜
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 快速跳轉選單 -->
    <div class="quick-nav">
        <div class="quick-nav-menu" id="quickNavMenu">
            <div class="quick-nav-item" onclick="showSection('prepare'); toggleQuickNav();">📋 行前準備</div>
            <div class="quick-nav-item" onclick="showSection('transport'); toggleQuickNav();">🚃 交通指南</div>
            <div class="quick-nav-item" onclick="showSection('day1'); toggleQuickNav();">📅 Day 1</div>
            <div class="quick-nav-item" onclick="showSection('day2'); toggleQuickNav();">📅 Day 2</div>
            <div class="quick-nav-item" onclick="showSection('day3'); toggleQuickNav();">📅 Day 3</div>
            <div class="quick-nav-item" onclick="showSection('day4'); toggleQuickNav();">📅 Day 4</div>
            <div class="quick-nav-item" onclick="showSection('day5'); toggleQuickNav();">📅 Day 5</div>
            <div class="quick-nav-item" onclick="showSection('day6'); toggleQuickNav();">📅 Day 6</div>
            <div class="quick-nav-item" onclick="showSection('day7'); toggleQuickNav();">📅 Day 7</div>
            <div class="quick-nav-item" onclick="showSection('day8'); toggleQuickNav();">📅 Day 8</div>
            <div class="quick-nav-item" onclick="showSection('restaurants'); toggleQuickNav();">🍜 美食推薦</div>
            <div class="quick-nav-item" onclick="showSection('emergency'); toggleQuickNav();">🆘 緊急聯絡</div>
        </div>
        <button class="quick-nav-toggle" onclick="toggleQuickNav()" aria-label="快速跳轉">
            ☰
        </button>
    </div>

    <!-- 返回頂部按鈕 -->
    <button class="back-to-top" id="backToTop" onclick="scrollToTop()" aria-label="返回頂部">
        ↑
    </button>

    <!-- 分享彈窗 -->
    <div class="share-modal" id="shareModal">
        <div class="share-modal-content">
            <div class="share-modal-header">
                <div class="share-modal-title">📤 分享旅遊指南</div>
                <button class="share-close-btn" onclick="closeShareModal()" aria-label="關閉">×</button>
            </div>

            <div class="share-options">
                <button class="share-option-btn" onclick="shareViaWebAPI()">
                    <span class="share-option-icon">🔗</span>
                    <div class="share-option-text">
                        <span class="share-option-label">快速分享</span>
                        <span class="share-option-desc">使用系統分享功能（支援行動裝置）</span>
                    </div>
                </button>

                <button class="share-option-btn" onclick="copyLink()">
                    <span class="share-option-icon">📋</span>
                    <div class="share-option-text">
                        <span class="share-option-label">複製網址</span>
                        <span class="share-option-desc">複製此頁面的連結</span>
                    </div>
                </button>

                <button class="share-option-btn" onclick="copyTravelSummary()">
                    <span class="share-option-icon">📝</span>
                    <div class="share-option-text">
                        <span class="share-option-label">複製旅遊摘要</span>
                        <span class="share-option-desc">複製完整行程重點文字</span>
                    </div>
                </button>

                <button class="share-option-btn" onclick="copyFavorites()">
                    <span class="share-option-icon">⭐</span>
                    <div class="share-option-text">
                        <span class="share-option-label">複製我的收藏</span>
                        <span class="share-option-desc">分享你收藏的景點與餐廳</span>
                    </div>
                </button>
            </div>

            <div class="share-preview" id="sharePreview" style="display: none;">
                <div class="share-preview-title">預覽內容</div>
                <div class="share-preview-content" id="sharePreviewContent"></div>
            </div>
        </div>
    </div>

    <!-- 分享成功提示 -->
    <div class="share-success" id="shareSuccess">✓ 已複製到剪貼簿</div>

    <script>
        function showSection(sectionId) {
            // 隱藏所有section
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // 顯示選中的section
            document.getElementById(sectionId).classList.add('active');

            // 更新tab狀態
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // 滾動到頂部
            window.scrollTo(0, 0);
        }

        // 待辦清單持久化功能
        function saveCheckboxState() {
            const checkboxes = document.querySelectorAll('.checkbox');
            const states = {};
            checkboxes.forEach((checkbox, index) => {
                states[index] = checkbox.checked;
            });
            localStorage.setItem('hokkaidoChecklist', JSON.stringify(states));

            // 更新進度條
            updateProgress();
        }

        function loadCheckboxState() {
            const saved = localStorage.getItem('hokkaidoChecklist');
            if (saved) {
                const states = JSON.parse(saved);
                const checkboxes = document.querySelectorAll('.checkbox');
                checkboxes.forEach((checkbox, index) => {
                    if (states[index] !== undefined) {
                        checkbox.checked = states[index];
                    }
                });
            }
        }

        // 深色模式切換功能
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.getElementById('theme-icon');

            body.classList.toggle('dark-mode');

            if (body.classList.contains('dark-mode')) {
                themeIcon.textContent = '☀️';
                localStorage.setItem('theme', 'dark');
            } else {
                themeIcon.textContent = '🌙';
                localStorage.setItem('theme', 'light');
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const themeIcon = document.getElementById('theme-icon');

            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                themeIcon.textContent = '☀️';
            }
        }

        // 返回頂部功能
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function toggleBackToTop() {
            const backToTop = document.getElementById('backToTop');
            if (window.scrollY > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        }

        // 快速跳轉選單
        function toggleQuickNav() {
            const menu = document.getElementById('quickNavMenu');
            menu.classList.toggle('show');
        }

        // 點擊外部關閉選單
        document.addEventListener('click', function(event) {
            const quickNav = document.querySelector('.quick-nav');
            const menu = document.getElementById('quickNavMenu');

            if (quickNav && !quickNav.contains(event.target)) {
                menu.classList.remove('show');
            }
        });

        // 進度追蹤系統
        function updateProgress() {
            const checkboxes = document.querySelectorAll('.checkbox');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const totalCount = checkboxes.length;
            const percentage = totalCount > 0 ? Math.round((checkedCount / totalCount) * 100) : 0;

            // 更新整體進度條
            const progressBar = document.getElementById('overall-progress-bar');
            const progressText = document.getElementById('overall-progress-text');

            if (progressBar && progressText) {
                progressBar.style.width = percentage + '%';
                progressText.textContent = percentage + '%';
            }

            // 添加完成動畫效果
            if (percentage === 100) {
                progressBar.style.boxShadow = '0 0 20px rgba(74, 222, 128, 0.8)';
            } else {
                progressBar.style.boxShadow = '0 0 10px rgba(74, 222, 128, 0.5)';
            }
        }

        // 頁面載入時執行
        document.addEventListener('DOMContentLoaded', function() {
            // 載入主題設定
            loadTheme();

            // 載入checkbox狀態
            loadCheckboxState();

            // 載入餐廳卡片摺疊狀態
            loadRestaurantStates();

            // 載入時間軸摺疊狀態
            loadTimelineStates();

            // 為所有checkbox添加事件監聽
            const checkboxes = document.querySelectorAll('.checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', saveCheckboxState);
            });

            // 監聽滾動事件來控制返回頂部按鈕
            window.addEventListener('scroll', toggleBackToTop);

            // 初始化進度條
            updateProgress();

            // 初始化收藏與筆記系統
            initFavoritesAndNotes();
        });

        // 收藏與筆記系統
        function initFavoritesAndNotes() {
            // 為所有具有data-item-id的元素添加收藏和筆記按鈕
            const items = document.querySelectorAll('[data-item-id]');
            items.forEach(item => {
                const itemId = item.getAttribute('data-item-id');

                // 如果還沒有actions區域，創建一個
                if (!item.querySelector('.item-actions')) {
                    const actionsDiv = document.createElement('div');
                    actionsDiv.className = 'item-actions';
                    actionsDiv.innerHTML = `
                        <button class="favorite-btn" onclick="toggleFavorite('${itemId}')" title="收藏">
                            <span class="star-icon">☆</span>
                        </button>
                        <button class="note-btn" onclick="toggleNote('${itemId}')" title="添加筆記">
                            📝 筆記
                        </button>
                        <div class="note-container" id="note-container-${itemId}"></div>
                    `;
                    item.appendChild(actionsDiv);
                }
            });

            // 載入保存的收藏和筆記
            loadFavoritesAndNotes();
        }

        function toggleFavorite(itemId) {
            const favorites = JSON.parse(localStorage.getItem('hokkaidoFavorites') || '{}');
            const btn = document.querySelector(`[data-item-id="${itemId}"] .favorite-btn`);
            const starIcon = btn.querySelector('.star-icon');

            if (favorites[itemId]) {
                delete favorites[itemId];
                btn.classList.remove('favorited');
                starIcon.textContent = '☆';
            } else {
                favorites[itemId] = true;
                btn.classList.add('favorited');
                starIcon.textContent = '★';
            }

            localStorage.setItem('hokkaidoFavorites', JSON.stringify(favorites));
        }

        function toggleNote(itemId) {
            const container = document.getElementById(`note-container-${itemId}`);
            const noteBtn = document.querySelector(`[data-item-id="${itemId}"] .note-btn`);

            if (container.classList.contains('show')) {
                container.classList.remove('show');
                return;
            }

            // 檢查是否已有筆記
            const notes = JSON.parse(localStorage.getItem('hokkaidoNotes') || '{}');
            const existingNote = notes[itemId] || '';

            if (existingNote) {
                // 顯示現有筆記
                container.innerHTML = `
                    <div class="note-display">${existingNote}</div>
                    <button class="note-edit-btn" onclick="editNote('${itemId}')">編輯</button>
                `;
            } else {
                // 顯示新增筆記表單
                container.innerHTML = `
                    <textarea class="note-textarea" id="note-input-${itemId}" placeholder="在此輸入筆記..."></textarea>
                    <div class="note-actions">
                        <button class="note-save-btn" onclick="saveNote('${itemId}')">保存</button>
                        <button class="note-cancel-btn" onclick="cancelNote('${itemId}')">取消</button>
                    </div>
                `;
            }

            container.classList.add('show');
        }

        function editNote(itemId) {
            const container = document.getElementById(`note-container-${itemId}`);
            const notes = JSON.parse(localStorage.getItem('hokkaidoNotes') || '{}');
            const existingNote = notes[itemId] || '';

            container.innerHTML = `
                <textarea class="note-textarea" id="note-input-${itemId}" placeholder="在此輸入筆記...">${existingNote}</textarea>
                <div class="note-actions">
                    <button class="note-save-btn" onclick="saveNote('${itemId}')">保存</button>
                    <button class="note-cancel-btn" onclick="cancelNote('${itemId}')">取消</button>
                </div>
            `;
        }

        function saveNote(itemId) {
            const input = document.getElementById(`note-input-${itemId}`);
            const noteText = input.value.trim();
            const container = document.getElementById(`note-container-${itemId}`);
            const noteBtn = document.querySelector(`[data-item-id="${itemId}"] .note-btn`);

            if (noteText) {
                const notes = JSON.parse(localStorage.getItem('hokkaidoNotes') || '{}');
                notes[itemId] = noteText;
                localStorage.setItem('hokkaidoNotes', JSON.stringify(notes));

                // 更新按鈕樣式
                noteBtn.classList.add('has-note');
                noteBtn.textContent = '📝 已有筆記';

                // 顯示保存的筆記
                container.innerHTML = `
                    <div class="note-display">${noteText}</div>
                    <button class="note-edit-btn" onclick="editNote('${itemId}')">編輯</button>
                `;
            } else {
                // 如果筆記為空，刪除它
                const notes = JSON.parse(localStorage.getItem('hokkaidoNotes') || '{}');
                delete notes[itemId];
                localStorage.setItem('hokkaidoNotes', JSON.stringify(notes));

                noteBtn.classList.remove('has-note');
                noteBtn.textContent = '📝 筆記';
                container.classList.remove('show');
            }
        }

        function cancelNote(itemId) {
            const container = document.getElementById(`note-container-${itemId}`);
            container.classList.remove('show');
        }

        function loadFavoritesAndNotes() {
            const favorites = JSON.parse(localStorage.getItem('hokkaidoFavorites') || '{}');
            const notes = JSON.parse(localStorage.getItem('hokkaidoNotes') || '{}');

            // 恢復收藏狀態
            Object.keys(favorites).forEach(itemId => {
                const btn = document.querySelector(`[data-item-id="${itemId}"] .favorite-btn`);
                if (btn) {
                    btn.classList.add('favorited');
                    const starIcon = btn.querySelector('.star-icon');
                    if (starIcon) starIcon.textContent = '★';
                }
            });

            // 恢復筆記按鈕狀態
            Object.keys(notes).forEach(itemId => {
                const noteBtn = document.querySelector(`[data-item-id="${itemId}"] .note-btn`);
                if (noteBtn) {
                    noteBtn.classList.add('has-note');
                    noteBtn.textContent = '📝 已有筆記';
                }
            });
        }

        // 搜尋與過濾系統
        let currentFilter = 'all';

        function performSearch() {
            const searchInput = document.getElementById('searchInput');
            const clearBtn = document.getElementById('clearSearch');
            const resultsInfo = document.getElementById('searchResultsInfo');
            const searchTerm = searchInput.value.toLowerCase().trim();

            // 顯示/隱藏清除按鈕
            if (searchTerm.length > 0) {
                clearBtn.classList.add('show');
                document.getElementById('searchIcon').style.display = 'none';
            } else {
                clearBtn.classList.remove('show');
                document.getElementById('searchIcon').style.display = 'block';
            }

            // 獲取所有餐廳卡片
            const restaurantCards = document.querySelectorAll('.restaurant-card[data-item-id]');
            let visibleCount = 0;

            restaurantCards.forEach(card => {
                // 移除之前的高亮
                removeHighlight(card);

                const text = card.textContent.toLowerCase();
                const matchesSearch = searchTerm === '' || text.includes(searchTerm);
                const matchesFilter = currentFilter === 'all' ||
                    card.querySelector('.restaurant-type')?.textContent.includes(currentFilter);

                if (matchesSearch && matchesFilter) {
                    card.style.display = 'block';
                    visibleCount++;

                    // 如果有搜尋詞，高亮匹配的文字
                    if (searchTerm) {
                        highlightText(card, searchTerm);
                    }
                } else {
                    card.style.display = 'none';
                }
            });

            // 顯示搜尋結果資訊
            if (searchTerm.length > 0 || currentFilter !== 'all') {
                resultsInfo.textContent = `找到 ${visibleCount} 間餐廳`;
                resultsInfo.classList.add('show');
            } else {
                resultsInfo.classList.remove('show');
            }

            // 如果沒有結果，顯示提示
            updateNoResultsMessage(visibleCount);
        }

        function highlightText(element, searchTerm) {
            const name = element.querySelector('.restaurant-name');
            const detail = element.querySelector('.restaurant-detail');

            if (name) {
                const originalText = name.textContent;
                const regex = new RegExp(`(${escapeRegex(searchTerm)})`, 'gi');
                const highlightedText = originalText.replace(regex, '<span class="highlight">$1</span>');
                if (highlightedText !== originalText) {
                    name.innerHTML = highlightedText;
                }
            }

            if (detail) {
                const originalHtml = detail.innerHTML;
                const regex = new RegExp(`(${escapeRegex(searchTerm)})`, 'gi');
                const highlightedHtml = originalHtml.replace(regex, '<span class="highlight">$1</span>');
                if (highlightedHtml !== originalHtml) {
                    detail.innerHTML = highlightedHtml;
                }
            }
        }

        function removeHighlight(element) {
            const highlights = element.querySelectorAll('.highlight');
            highlights.forEach(highlight => {
                const text = highlight.textContent;
                highlight.replaceWith(text);
            });
        }

        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function clearSearch() {
            const searchInput = document.getElementById('searchInput');
            searchInput.value = '';
            performSearch();
            searchInput.focus();
        }

        function filterItems(filterType) {
            currentFilter = filterType;

            // 更新按鈕狀態
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.getAttribute('data-filter') === filterType) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            // 執行搜尋（會考慮當前的過濾條件）
            performSearch();
        }

        function updateNoResultsMessage(visibleCount) {
            const section = document.getElementById('restaurants');
            let noResultsDiv = section.querySelector('.search-no-results');

            if (visibleCount === 0) {
                if (!noResultsDiv) {
                    noResultsDiv = document.createElement('div');
                    noResultsDiv.className = 'search-no-results';
                    noResultsDiv.innerHTML = `
                        <div class="search-no-results-icon">🔍</div>
                        <div>找不到符合條件的餐廳</div>
                        <div style="font-size: 13px; margin-top: 10px; opacity: 0.7;">
                            試試調整搜尋詞或過濾條件
                        </div>
                    `;
                    section.appendChild(noResultsDiv);
                }
            } else {
                if (noResultsDiv) {
                    noResultsDiv.remove();
                }
            }
        }

        // ==================== 時間軸摺疊/展開功能 ====================

        function initTimelineCollapse() {
            const timelines = document.querySelectorAll('.timeline');

            timelines.forEach((timeline, sectionIndex) => {
                // 為每個時間軸添加控制按鈕
                const section = timeline.closest('.section');
                if (section) {
                    const sectionId = section.id;

                    // 添加控制按鈕（只在有 timeline 的 section 中）
                    if (!timeline.previousElementSibling || !timeline.previousElementSibling.classList.contains('timeline-controls')) {
                        const controlsDiv = document.createElement('div');
                        controlsDiv.className = 'timeline-controls';
                        controlsDiv.innerHTML = `
                            <button class="timeline-control-btn" onclick="toggleAllTimeline('${sectionId}', false)" title="收合全部">
                                ▲ 收合全部
                            </button>
                            <button class="timeline-control-btn" onclick="toggleAllTimeline('${sectionId}', true)" title="展開全部">
                                ▼ 展開全部
                            </button>
                        `;
                        timeline.parentNode.insertBefore(controlsDiv, timeline);
                    }
                }

                // 為每個時間軸項目添加摺疊按鈕
                const items = timeline.querySelectorAll('.timeline-item');
                items.forEach((item, itemIndex) => {
                    const activityTitle = item.querySelector('.activity-title');
                    const activityDetail = item.querySelector('.activity-detail');

                    if (activityTitle && activityDetail) {
                        // 創建包裹元素
                        const header = document.createElement('div');
                        header.className = 'timeline-header';

                        // 創建切換按鈕
                        const toggleBtn = document.createElement('button');
                        toggleBtn.className = 'timeline-toggle-btn expanded';
                        toggleBtn.setAttribute('aria-label', '展開/收合');

                        const itemId = `timeline-${sectionIndex}-${itemIndex}`;
                        toggleBtn.onclick = () => toggleTimelineItem(itemId);

                        // 設置 data 屬性
                        item.setAttribute('data-timeline-id', itemId);

                        // 將標題移入 header
                        header.appendChild(activityTitle.cloneNode(true));
                        header.appendChild(toggleBtn);

                        // 替換原標題
                        item.replaceChild(header, activityTitle);
                    }
                });
            });

            // 載入保存的狀態
            loadTimelineStates();
        }

        function toggleTimelineItem(itemId) {
            const item = document.querySelector(`[data-timeline-id="${itemId}"]`);
            if (!item) return;

            const toggleBtn = item.querySelector('.timeline-toggle-btn');
            const isCollapsed = item.classList.contains('collapsed');

            if (isCollapsed) {
                item.classList.remove('collapsed');
                toggleBtn.classList.remove('collapsed');
                toggleBtn.classList.add('expanded');
            } else {
                item.classList.add('collapsed');
                toggleBtn.classList.remove('expanded');
                toggleBtn.classList.add('collapsed');
            }

            // 保存狀態
            saveTimelineState(itemId, !isCollapsed);
        }

        // 每日摘要摺疊功能
        function toggleSummary(headerElement) {
            const summaryDiv = headerElement.parentElement;
            summaryDiv.classList.toggle('collapsed');

            // 保存狀態到 localStorage
            const daySection = summaryDiv.closest('.section');
            if (daySection) {
                const dayId = daySection.id;
                const isCollapsed = summaryDiv.classList.contains('collapsed');
                const states = JSON.parse(localStorage.getItem('summarStates') || '{}');
                states[dayId] = isCollapsed;
                localStorage.setItem('summaryStates', JSON.stringify(states));
            }
        }

        // 載入摘要狀態
        function loadSummaryStates() {
            const states = JSON.parse(localStorage.getItem('summaryStates') || '{}');
            Object.keys(states).forEach(dayId => {
                const section = document.getElementById(dayId);
                if (section && states[dayId]) {
                    const summary = section.querySelector('.day-summary');
                    if (summary) {
                        summary.classList.add('collapsed');
                    }
                }
            });
        }

        function toggleAllTimeline(sectionId, expand) {
            const section = document.getElementById(sectionId);
            if (!section) return;

            const items = section.querySelectorAll('.timeline-item');
            items.forEach(item => {
                const toggleBtn = item.querySelector('.timeline-toggle-btn');
                if (!toggleBtn) return;

                if (expand) {
                    item.classList.remove('collapsed');
                    toggleBtn.classList.remove('collapsed');
                    toggleBtn.classList.add('expanded');
                } else {
                    item.classList.add('collapsed');
                    toggleBtn.classList.remove('expanded');
                    toggleBtn.classList.add('collapsed');
                }

                // 保存狀態
                const itemId = item.getAttribute('data-timeline-id');
                if (itemId) {
                    saveTimelineState(itemId, !expand);
                }
            });
        }

        function saveTimelineState(itemId, isCollapsed) {
            const states = JSON.parse(localStorage.getItem('timelineStates') || '{}');
            states[itemId] = isCollapsed;
            localStorage.setItem('timelineStates', JSON.stringify(states));
        }

        function loadTimelineStates() {
            const states = JSON.parse(localStorage.getItem('timelineStates') || '{}');

            for (const itemId in states) {
                const item = document.querySelector(`[data-timeline-id="${itemId}"]`);
                if (item && states[itemId]) {
                    const toggleBtn = item.querySelector('.timeline-toggle-btn');
                    item.classList.add('collapsed');
                    if (toggleBtn) {
                        toggleBtn.classList.remove('expanded');
                        toggleBtn.classList.add('collapsed');
                    }
                }
            }
        }

        // 頁面載入時初始化
        document.addEventListener('DOMContentLoaded', function() {
            initTimelineCollapse();
            loadSummaryStates();
        });

        // ==================== 分享功能 ====================

        function openShareModal() {
            const modal = document.getElementById('shareModal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeShareModal() {
            const modal = document.getElementById('shareModal');
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';

            // 隱藏預覽
            document.getElementById('sharePreview').style.display = 'none';
        }

        // 關閉彈窗 - 點擊背景
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('shareModal');
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeShareModal();
                }
            });
        });

        // Web Share API（行動裝置優先）
        async function shareViaWebAPI() {
            const shareData = {
                title: '北海道家庭旅遊指南 | 2025.10.11-10.18',
                text: '8天7夜北海道家庭旅遊完整攻略，涵蓋札幌、小樽、函館等熱門景點、交通指南、美食推薦及行前準備。',
                url: window.location.href
            };

            try {
                if (navigator.share) {
                    await navigator.share(shareData);
                    showShareSuccess('分享成功！');
                    closeShareModal();
                } else {
                    // 如果不支援 Web Share API，回退到複製連結
                    await copyLink();
                }
            } catch (err) {
                if (err.name !== 'AbortError') {
                    console.error('分享失敗:', err);
                    await copyLink();
                }
            }
        }

        // 複製連結
        async function copyLink() {
            try {
                await navigator.clipboard.writeText(window.location.href);
                showShareSuccess('連結已複製！');
                closeShareModal();
            } catch (err) {
                console.error('複製失敗:', err);
                // Fallback
                fallbackCopyText(window.location.href);
            }
        }

        // 生成旅遊摘要
        function generateTravelSummary() {
            return `🗾 北海道家庭旅遊指南
📅 旅遊日期：2025.10.11 - 10.18（8天7夜）
👨‍👩‍👧‍👦 人數：4人同行

📍 主要城市路線
• 新千歲機場 → 札幌（3晚）
• 小樽（1日遊）
• 函館（2晚）
• 札幌 → 新千歲機場

🏨 住宿安排
• 札幌：Hotel Gracery Sapporo（3晚）
• 函館：La Vista Hakodate Bay（2晚）
• 札幌：札幌站前大和ROYNET飯店（2晚）

🚃 交通票券
• JR北海道鐵路周遊券（5日券）
• Welcome Pass札幌地鐵1日券
• 函館市電1日券

🍜 必吃美食
• 札幌：元祖拉麵橫丁、蟹將軍、海鮮丼
• 小樽：政壽司、LeTAO芝士蛋糕
• 函館：小丑漢堡、幸運小丑、村上海膽店

🏛️ 必訪景點
• 札幌：大通公園、狸小路、時計台
• 小樽：運河、音樂盒館、北一硝子
• 函館：函館山夜景、五稜郭、金森倉庫

💰 預估預算（每人）
• 機票：NT$ 15,000-20,000
• 住宿：NT$ 12,000-15,000
• 交通：NT$ 5,000-6,000
• 餐飲：NT$ 10,000-12,000
• 購物：NT$ 8,000-10,000
────────────────────
總計：NT$ 50,000-63,000/人

🌐 網址：${window.location.href}

✨ 用 Claude Code 製作的旅遊指南
`;
        }

        // 複製旅遊摘要
        async function copyTravelSummary() {
            const summary = generateTravelSummary();

            // 顯示預覽
            document.getElementById('sharePreviewContent').textContent = summary;
            document.getElementById('sharePreview').style.display = 'block';

            try {
                await navigator.clipboard.writeText(summary);
                showShareSuccess('旅遊摘要已複製！');

                setTimeout(() => {
                    closeShareModal();
                }, 1500);
            } catch (err) {
                console.error('複製失敗:', err);
                fallbackCopyText(summary);
            }
        }

        // 複製收藏清單
        async function copyFavorites() {
            const favorites = JSON.parse(localStorage.getItem('hokkaidoFavorites') || '{}');
            const notes = JSON.parse(localStorage.getItem('hokkaidoNotes') || '{}');

            if (Object.keys(favorites).length === 0) {
                showShareSuccess('您還沒有收藏任何項目！', 'warning');
                return;
            }

            let favoritesText = '⭐ 我的北海道旅遊收藏\n\n';

            // 收集所有收藏項目的資訊
            for (const itemId in favorites) {
                const element = document.querySelector(`[data-item-id="${itemId}"]`);
                if (element) {
                    // 取得項目標題
                    const titleElement = element.querySelector('h3, .restaurant-name, .day-title');
                    const title = titleElement ? titleElement.textContent.trim() : itemId;

                    favoritesText += `📍 ${title}\n`;

                    // 如果有筆記，加入筆記內容
                    if (notes[itemId]) {
                        favoritesText += `   💭 ${notes[itemId]}\n`;
                    }

                    favoritesText += '\n';
                }
            }

            favoritesText += `\n🌐 完整指南：${window.location.href}\n`;
            favoritesText += `\n✨ 用 Claude Code 製作的旅遊指南`;

            // 顯示預覽
            document.getElementById('sharePreviewContent').textContent = favoritesText;
            document.getElementById('sharePreview').style.display = 'block';

            try {
                await navigator.clipboard.writeText(favoritesText);
                showShareSuccess('收藏清單已複製！');

                setTimeout(() => {
                    closeShareModal();
                }, 1500);
            } catch (err) {
                console.error('複製失敗:', err);
                fallbackCopyText(favoritesText);
            }
        }

        // 顯示成功訊息
        function showShareSuccess(message, type = 'success') {
            const successDiv = document.getElementById('shareSuccess');
            successDiv.textContent = type === 'success' ? `✓ ${message}` : `ℹ ${message}`;
            successDiv.style.background = type === 'success' ? '#4ade80' : '#f8b500';
            successDiv.classList.add('show');

            setTimeout(() => {
                successDiv.classList.remove('show');
            }, 3000);
        }

        // Fallback 複製方法（舊版瀏覽器）
        function fallbackCopyText(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showShareSuccess('已複製到剪貼簿！');
                    setTimeout(() => {
                        closeShareModal();
                    }, 1500);
                } else {
                    showShareSuccess('複製失敗，請手動複製', 'warning');
                }
            } catch (err) {
                console.error('Fallback 複製失敗:', err);
                showShareSuccess('複製失敗，請手動複製', 'warning');
            }

            document.body.removeChild(textArea);
        }
    </script>

    <!-- 浮動提醒按鈕 -->
    <button class="floating-alerts-btn" onclick="toggleAlertsPanel()" aria-label="關鍵提醒">
        🔔
        <span class="badge-count" id="alertsCount">0</span>
    </button>

    <!-- 背景遮罩 -->
    <div class="alerts-overlay" id="alertsOverlay" onclick="closeAlertsPanel()"></div>

    <!-- 提醒側邊面板 -->
    <div class="alerts-panel" id="alertsPanel">
        <div class="alerts-panel-header">
            <div class="alerts-panel-title">⚠️ 關鍵提醒</div>
            <button class="alerts-panel-close" onclick="closeAlertsPanel()" aria-label="關閉">×</button>
        </div>
        <div class="alerts-panel-content" id="alertsPanelContent">
            <!-- 動態生成內容 -->
        </div>
    </div>

    <script>
        // ==================== 餐廳卡片摺疊功能 ====================

        function toggleRestaurantDetail(restaurantId) {
            const card = document.querySelector(`.restaurant-card[data-item-id="${restaurantId}"]`);
            if (!card) return;

            const isExpanded = card.classList.toggle('expanded');

            // 更新按鈕文字
            const btn = card.querySelector('.restaurant-expand-btn span:first-child');
            if (btn) {
                btn.textContent = isExpanded ? '收起詳情' : '查看詳情';
            }

            // 保存狀態到 localStorage
            const states = JSON.parse(localStorage.getItem('restaurantStates') || '{}');
            states[restaurantId] = isExpanded;
            localStorage.setItem('restaurantStates', JSON.stringify(states));
        }

        function loadRestaurantStates() {
            const states = JSON.parse(localStorage.getItem('restaurantStates') || '{}');
            Object.keys(states).forEach(restaurantId => {
                if (states[restaurantId]) {
                    const card = document.querySelector(`.restaurant-card[data-item-id="${restaurantId}"]`);
                    if (card) {
                        card.classList.add('expanded');
                        const btn = card.querySelector('.restaurant-expand-btn span:first-child');
                        if (btn) {
                            btn.textContent = '收起詳情';
                        }
                    }
                }
            });
        }

        // ==================== 時間軸摺疊功能 ====================

        function toggleTimelineDetail(itemId) {
            const item = document.querySelector(`.timeline-item[data-item-id="${itemId}"]`);
            if (!item) return;

            const isExpanded = item.classList.toggle('expanded');

            // 更新按鈕文字
            const btn = item.querySelector('.timeline-expand-btn span:first-child');
            if (btn) {
                btn.textContent = isExpanded ? '收起' : '詳情';
            }

            // 保存狀態到 localStorage
            const states = JSON.parse(localStorage.getItem('timelineStates') || '{}');
            states[itemId] = isExpanded;
            localStorage.setItem('timelineStates', JSON.stringify(states));
        }

        function loadTimelineStates() {
            const states = JSON.parse(localStorage.getItem('timelineStates') || '{}');
            Object.keys(states).forEach(itemId => {
                if (states[itemId]) {
                    const item = document.querySelector(`.timeline-item[data-item-id="${itemId}"]`);
                    if (item) {
                        item.classList.add('expanded');
                        const btn = item.querySelector('.timeline-expand-btn span:first-child');
                        if (btn) {
                            btn.textContent = '收起';
                        }
                    }
                }
            });
        }

        // ==================== 關鍵提醒系統 ====================

        const keyAlerts = {
            day1: {
                timeCritical: [
                    '05:00 從家出發去機場',
                    'かに將軍建議 17:30 預約'
                ],
                booking: [
                    'かに將軍需提前預約'
                ],
                cost: [
                    '機場購買 ICOCA ¥2,000',
                    'JR Pass ¥22,000'
                ],
                info: [
                    '狸小路商店街營業至 21:00'
                ]
            },
            day2: {
                timeCritical: [
                    '購買ドニチカキップ ¥520（週日券）',
                    '札幌電視塔營業至 21:00'
                ],
                cost: [
                    '白色戀人公園 ¥800',
                    '圓山神宮巴士 ¥210'
                ],
                info: [
                    '達摩成吉思汗烤肉無需預約'
                ]
            },
            day3: {
                timeCritical: [
                    'JR Pass 今日開始使用（第1天）',
                    '12:30 前務必回小樽站',
                    '13:42 搭特急北斗往洞爺'
                ],
                booking: [
                    '午餐建議 11:00 前抵達避開人潮'
                ],
                cost: [
                    '洞爺湖飯店無接駁車',
                    '巴士 ¥340 或計程車 ¥2,000-3,000'
                ],
                info: [
                    '六花亭現烤餅免費（每人限2個）',
                    '煙火 20:45（10月下旬可能已結束）'
                ]
            },
            day4: {
                timeCritical: [
                    'JR Pass 今日休息不使用'
                ],
                cost: [
                    '有珠山纜車 ¥1,800',
                    '洞爺湖遊覽船 ¥1,500',
                    '巴士班次少，注意時刻表'
                ],
                info: [
                    '煙火 20:45（10月下旬可能已結束）',
                    '可請飯店協助查詢巴士時刻'
                ]
            },
            day5: {
                timeCritical: [
                    '11:00 退房',
                    '特急北斗 12:12 往函館',
                    '16:30 日落，提早上函館山'
                ],
                cost: [
                    '函館市電一日券 ¥600',
                    '函館山纜車 ¥1,500'
                ],
                booking: [
                    '函館山週末大排隊，建議提早'
                ],
                info: [
                    'JR Pass 第3天'
                ]
            },
            day6: {
                timeCritical: [
                    '函館朝市 06:00 營業',
                    '10:00 退房'
                ],
                cost: [
                    '市電一日券 ¥600'
                ],
                info: [
                    '教堂區免費參觀',
                    '大門橫丁晚餐'
                ]
            },
            day7: {
                timeCritical: [
                    '08:30 退房',
                    '特急北斗 09:03 返札幌',
                    'JR Pass 最後一天（第5天）'
                ],
                cost: [
                    '白色戀人公園 ¥800'
                ],
                info: [
                    '狸小路最後採購機會'
                ]
            },
            day8: {
                timeCritical: [
                    '07:00 退房',
                    'JR 快速 07:30 往機場',
                    '預留2小時，13:30 起飛'
                ],
                cost: [
                    '機場快線 ¥1,170 或 ICOCA'
                ],
                info: [
                    '機場最後採購伴手禮'
                ]
            }
        };

        function toggleAlertsPanel() {
            const panel = document.getElementById('alertsPanel');
            const overlay = document.getElementById('alertsOverlay');

            if (panel.classList.contains('show')) {
                closeAlertsPanel();
            } else {
                panel.classList.add('show');
                overlay.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeAlertsPanel() {
            const panel = document.getElementById('alertsPanel');
            const overlay = document.getElementById('alertsOverlay');

            panel.classList.remove('show');
            overlay.classList.remove('show');
            document.body.style.overflow = '';
        }

        function initAlertsPanel() {
            const content = document.getElementById('alertsPanelContent');
            let totalCount = 0;
            let html = '';

            // 生成所有天的提醒
            Object.keys(keyAlerts).forEach(dayKey => {
                const dayNum = dayKey.replace('day', '');
                const alerts = keyAlerts[dayKey];
                const dayTitle = `Day ${dayNum}`;

                let dayHtml = `<div class="alert-group">
                    <div class="alert-group-title">📅 ${dayTitle}</div>`;

                // 時間敏感提醒
                if (alerts.timeCritical && alerts.timeCritical.length > 0) {
                    alerts.timeCritical.forEach(alert => {
                        dayHtml += `<div class="alert-item time-critical">
                            <div class="alert-item-day">⏰ 時間敏感</div>
                            ${alert}
                        </div>`;
                        totalCount++;
                    });
                }

                // 必須預約
                if (alerts.booking && alerts.booking.length > 0) {
                    alerts.booking.forEach(alert => {
                        dayHtml += `<div class="alert-item booking">
                            <div class="alert-item-day">📝 必須預約</div>
                            ${alert}
                        </div>`;
                        totalCount++;
                    });
                }

                // 重要費用
                if (alerts.cost && alerts.cost.length > 0) {
                    alerts.cost.forEach(alert => {
                        dayHtml += `<div class="alert-item cost">
                            <div class="alert-item-day">💰 重要費用</div>
                            ${alert}
                        </div>`;
                        totalCount++;
                    });
                }

                // 一般資訊
                if (alerts.info && alerts.info.length > 0) {
                    alerts.info.forEach(alert => {
                        dayHtml += `<div class="alert-item info">
                            <div class="alert-item-day">ℹ️ 重要資訊</div>
                            ${alert}
                        </div>`;
                        totalCount++;
                    });
                }

                dayHtml += `</div>`;
                html += dayHtml;
            });

            content.innerHTML = html;

            // 更新計數
            document.getElementById('alertsCount').textContent = totalCount;
        }

        // 頁面載入時初始化提醒面板
        document.addEventListener('DOMContentLoaded', function() {
            initAlertsPanel();
        });
    </script>
</body>
</html>